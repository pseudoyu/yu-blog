<!doctype html><html lang=zh itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.105.0"><meta charset=utf-8><title>Hugo + GitHub Action，搭建你的博客自动发布系统 · Pseudoyu</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script async defer data-website-id=058488c2-18d4-498a-b683-0a898b3f6c7a src=https://data.pseudoyu.com/pseudoyu.js></script>
<script data-goatcounter=https://stats.pseudoyu.com/count async src=//stats.pseudoyu.com/count.js></script><meta name=description content="《后来的我们 - 五月天》 前言 在之前的一篇《免费的个人博客系统搭建及部署解决方案（Hugo + GitHub Pages + Cusdis）》中，我提到了自己通过 Hugo 这个静态"><meta name=keywords content="hugo,blockchain,programming"><link rel=canonical href=https://www.pseudoyu.com/zh/2022/05/29/deploy_your_blog_using_hugo_and_github_action/><link rel=alternate href=https://www.pseudoyu.com/en/2022/05/29/deploy_your_blog_using_hugo_and_github_action/ hreflang=en><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href=https://www.pseudoyu.com/css/den.css><link rel=stylesheet href=https://www.pseudoyu.com/css/custom.css><meta property="og:title" content="Hugo + GitHub Action，搭建你的博客自动发布系统"><meta property="og:description" content="《后来的我们 - 五月天》 前言 在之前的一篇《免费的个人博客系统搭建及部署解决方案（Hugo + GitHub Pages + Cusdis）》中，我提到了自己通过 Hugo 这个静态"><meta property="og:type" content="article"><meta property="og:url" content="https://www.pseudoyu.com/zh/2022/05/29/deploy_your_blog_using_hugo_and_github_action/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-29T20:39:29+08:00"><meta property="article:modified_time" content="2022-05-29T20:39:29+08:00"><meta itemprop=name content="Hugo + GitHub Action，搭建你的博客自动发布系统"><meta itemprop=description content="《后来的我们 - 五月天》 前言 在之前的一篇《免费的个人博客系统搭建及部署解决方案（Hugo + GitHub Pages + Cusdis）》中，我提到了自己通过 Hugo 这个静态"><meta itemprop=datePublished content="2022-05-29T20:39:29+08:00"><meta itemprop=dateModified content="2022-05-29T20:39:29+08:00"><meta itemprop=wordCount content="3727"><meta itemprop=keywords content="hugo,github,github action,github pages,cloudflare,serverless,self-host,blog,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hugo + GitHub Action，搭建你的博客自动发布系统"><meta name=twitter:description content="《后来的我们 - 五月天》 前言 在之前的一篇《免费的个人博客系统搭建及部署解决方案（Hugo + GitHub Pages + Cusdis）》中，我提到了自己通过 Hugo 这个静态"></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://www.pseudoyu.com/images/background.webp);background-position:50%;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://www.pseudoyu.com/zh/><img class="mr20 header-logo-image" src=https://www.pseudoyu.com/images/fly.png alt=logo>
Pseudoyu</a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/category/ideas/>思考</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/category/tools/>工具</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/category/develop/>编程</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/links/>友链</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/about/>关于</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/search/>搜索</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/><i class="fas fa-globe"></i> English</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>Hugo + GitHub Action，搭建你的博客自动发布系统</h1><p class=header-date>作者:
pseudoyu
| <span>3727 字, 8 分钟</span>
| <span class=remark42__counter data-url=https://www.pseudoyu.com/zh/2022/05/29/deploy_your_blog_using_hugo_and_github_action/></span> 评论
| 2022-05-29
| 分类:
<a href=https://www.pseudoyu.com/zh/category/tools/>Tools</a></p><div class=header-underline></div><div class=clearfix></div><p class="float-right header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://www.pseudoyu.com/zh/tag/blog/>blog</a>,
<a href=https://www.pseudoyu.com/zh/tag/cloudflare/>cloudflare</a>,
<a href=https://www.pseudoyu.com/zh/tag/github/>github</a>,
<a href=https://www.pseudoyu.com/zh/tag/github-action/>github action</a>,
<a href=https://www.pseudoyu.com/zh/tag/github-pages/>github pages</a>,
<a href=https://www.pseudoyu.com/zh/tag/hugo/>hugo</a>,
<a href=https://www.pseudoyu.com/zh/tag/self-host/>self-host</a>,
<a href=https://www.pseudoyu.com/zh/tag/serverless/>serverless</a></p><div class=clearfix></div><p class="float-right translations"><i class="fas fa-language" aria-hidden=true></i>
翻译:
<a href=https://www.pseudoyu.com/en/2022/05/29/deploy_your_blog_using_hugo_and_github_action/>EN</a></p></div></div></div></div></div><main><div class="container content"><articl data-pagefind-body><figure><audio controls preload=metadata><source src=/audios/here_after_us.mp3 type=audio/mpeg></audio><i><figcaption>《后来的我们 - 五月天》</figcaption></i></figure><h2 id=前言>前言</h2><p>在之前的一篇《<a href=https://www.pseudoyu.com/zh/2022/03/24/free_blog_deploy_using_hugo_and_cusdis/>免费的个人博客系统搭建及部署解决方案（Hugo + GitHub Pages + Cusdis）</a>》中，我提到了自己通过 <a href=https://gohugo.io>Hugo</a> 这个静态网站生成器来真正搭建我的个人博客，并在 Hugo 开源社区中 <a href=https://github.com/shaform/hugo-theme-den>hugo-theme-den</a> 这个主题基础上进行了一些个人定制化改造和配置，满足了自己的需求。</p><p>我的方案主要分为以下几个核心部分：</p><ol><li>个人博客源仓库，对博客配置及所有文章 <code>.md</code> 源文件进行版本管理，配合 GitHub Action 进行自动化部署，自动生成静态站点推送到 GitHub Pages 博客发布仓库。</li><li>GitHub Pages 博客发布仓库，以 <code>username.github.io</code> 形式命名的仓库，使用 GitHub Pages 实现网站部署，可以通过配置域名 CNAME 解析使用自定义域名。</li><li>Hugo 主题仓库，fork 喜欢的主题，并对自己的个人定制化改造配置进行版本管理，通过 <code>git submodule</code> 的方式链接到个人博客源仓库。</li><li>其他组件源仓库，如 <a href=https://www.pseudoyu.com/zh/2022/05/21/free_blog_analysis_using_umami_vercel_and_heroku/>umami 网站数据统计</a>及 <a href=https://www.pseudoyu.com/zh/2022/05/24/free_and_lightweight_blog_comment_system_using_cusdis_and_railway/>Cusdis 网站评论系统</a>等。</li></ol><p>下文会对搭建、本地测试、自动化部署维护等过程进行详细讲解，希望对大家所有帮助。</p><h2 id=使用-hugo-搭建博客>使用 Hugo 搭建博客</h2><p><img src=https://image.pseudoyu.com/images/hugo_website.png alt=hugo_website></p><p><a href=https://gohugo.io>Hugo</a> 是用 Go 实现的博客工具，采用 Markdown 进行文章编辑，自动生成静态站点文件，支持丰富的主题配置，也可以通过 js 嵌入像是评论系统等插件，高度定制化。除了 Hugo 外， 还有 Gatsby、Jekyll、Hexo、Ghost 等选择，实现和使用都差不多，可以根据自己的偏好进行选择。</p><h3 id=安装-hugo>安装 Hugo</h3><p>我使用的是 macOS，所以使用官方推荐的 homebrew 方式进行 hugo 程序的安装，其他系统也类似。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>brew install hugo
</span></span></code></pre></div><p>完成后，使用以下命令进行验证：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo version
</span></span></code></pre></div><h3 id=创建-hugo-网站>创建 Hugo 网站</h3><p>通过上述命令安装 hugo 程序后，就可以通过 <code>hugo new site</code> 命令进行网站创建、配置与本地调试了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo new site blog-test
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/hugo_new_site.png alt=hugo_new_site></p><h3 id=配置主题>配置主题</h3><p>当通过上文命令创建我们的站点后，需要进行主题配置，Hugo 社区有了很丰富的主题，可以通过官网 <a href=https://themes.gohugo.io>Themes</a> 菜单选择自己喜欢的风格，查看预览效果，选择后可以进入主题项目仓库，一般都会有很详细的安装及配置说明。下面我就以我目前在使用的 <a href=https://github.com/shaform/hugo-theme-den>hugo-theme-den</a> 这个主题为例，演示一下配置流程。</p><h4 id=关联主题仓库>关联主题仓库</h4><p>我们可以将主题仓库直接 <code>git clone</code> 下来进行使用，但这种方式有一些弊端，当之后自己对主题进行修改后，可能会与原主题产生一些冲突，不方便版本管理与后续更新。我采用的是将原主题仓库 <code>fork</code> 到自己的账户，并使用 <code>git submodule</code> 方式进行仓库链接，这样后续可以对主题的修改进行单独维护。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> blog-test/
</span></span><span class=line><span class=cl>git init
</span></span><span class=line><span class=cl>git submodule add https://github.com/pseudoyu/hugo-theme-den themes/hugo-theme-den
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/hugo_init_theme.png alt=hugo_init_theme></p><h4 id=更新主题>更新主题</h4><p>如果是 clone 了其他人的博客项目进行修改，则需要用以下命令进行初始化：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git submodule update --init --recursive
</span></span></code></pre></div><p>如果需要同步主题仓库的最新修改，需要运行以下命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git submodule update --remote
</span></span></code></pre></div><h4 id=初始化主题配置及发布>初始化主题配置及发布</h4><p>每个主题一般都会提供一些实例配置与初始页面，开始使用主题时可以将其 <code>exampleSite/</code> 目录下的文件复制到站点目录下，在此基础上进行调整配置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp -rf themes/hugo-theme-den/exampleSite/* ./
</span></span></code></pre></div><p>初始化主题基础配置后，我们可以在 <code>config.toml</code> 文件中进行站点细节配置，具体配置项参考各主题说明文档。</p><p><img src=https://image.pseudoyu.com/images/hugo_theme_config.png alt=hugo_theme_config></p><p>完成后，可以通过 <code>hugo new</code> 命令发布新文章。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo new posts/blog-test.md
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/hugo_new_post.png alt=hugo_new_post></p><h4 id=本地调试站点>本地调试站点</h4><p>Hugo 会生成静态网页，我们在本地编辑调试时可以通过 <code>hugo server</code> 命令进行本地实时调试预览，无须每次都重新生成。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo server
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/hugo_server.png alt=hugo_server></p><p>运行服务后，我们可以通过浏览器 <code>http://localhost:1313</code> 地址访问我们的本地预览网页。</p><p><img src=https://image.pseudoyu.com/images/hugo_server_preview.png alt=hugo_server_preview></p><h3 id=使用-github-pages-前期准备>使用 GitHub Pages 前期准备</h3><h4 id=域名购买>域名购买</h4><p>作为一个对外发布的网站，我们需要购买一个域名并配置解析，指向我们网站所在的服务器，才能让外界以比较方便的方式访问。域名购买平台很多，我用过的有 <a href=https://www.cloudflare.com>Cloudflare</a>、<a href=https://www.namesilo.com>NameSilo</a>、<a href=https://www.godaddy.com>GoDaddy</a> 等，我最后常用的还是 Cloudflare，因为其同时还提供了 CDN、网站数据分析、定制规则等强大功能。</p><p>首先我们需要注册一个 Cloudflare 账户，登录后选择左侧边栏的“注册域”，并搜索自己想注册的域名。</p><p><img src=https://image.pseudoyu.com/images/cloudflare_register_domain.png alt=cloudflare_register_domain></p><p>选择了心仪的域名后，点击并选择购买时限并填写个人信息。</p><p><img src=https://image.pseudoyu.com/images/cloudflare_register_domain_choose.png alt=cloudflare_register_domain_choose></p><p>选择付款方式，建议可以选择自动续订，以免忘记续费。</p><p><img src=https://image.pseudoyu.com/images/cloudflare_register_domain_payment.png alt=cloudflare_register_domain_payment></p><p>类型选择 Personal 即可，并点击完成购买。</p><p><img src=https://image.pseudoyu.com/images/cloudflare_register_done.png alt=cloudflare_register_done></p><p>等待 Cloudflare 处理后即可查看信息。</p><p><img src=https://image.pseudoyu.com/images/cloudflare_domain.jpg alt=cloudflare_domain></p><h4 id=github-pages-仓库>GitHub Pages 仓库</h4><p>GitHub Pages 项目需要符合 <code>username.github.io</code> 的特殊命名格式，仓库建立完成后，可以在设置中配置自己注册的自定义域名来指向 GitHub Pages 生成的网址。此外，需要将博客站点配置文件 <code>config.toml</code> 中的 <code>baseURL</code> 改为自己的自定义域名，格式为 <code>"https://www.pseudoyu.com/"</code>，这样博客站点才能正常访问 GitHub Pages 生成的网站服务。</p><p><img src=https://image.pseudoyu.com/images/github_pages_repo.png alt=github_pages_repo></p><h4 id=域名解析>域名解析</h4><p>按照上文步骤注册好后，需要在域名托管商进行 DNS 解析，在这里我们需要选择 CNAME，指向我们的 GitHub Pages 网址。</p><p><img src=https://image.pseudoyu.com/images/cloudflare_cname_config.png alt=cloudflare_cname_config></p><p>因为 CNAME 解析没办法设置 root 域名，即只能设置 <code>www.pseudoyu.com</code> 或其他子域名，而不是 <code>pseudoyu.com</code>，因此，我们可以通过 Cloudflare 上自定义规则设置域名重定向，具体配置如下，仅需将我的域名替换成自己的域名即可。即使你是通过 NameSilo 注册的域名，也可以通过 Cloudflare 来添加站点以实现功能，或者其他托管平台也有类似的功能，按照说明配置即可。</p><p><img src=https://image.pseudoyu.com/images/cloudflare_cname_rule_config.png alt=cloudflare_cname_rule_config></p><h3 id=github-pages-发布博客>GitHub Pages 发布博客</h3><p>完成上述准备工作后，我们现在已经可以通过自定义域名来访问我们的 GitHub Pages 页面了，目前因为项目仓库是空的，访问后会报 <code>404</code> 页面。</p><p>我们希望 Hugo 生成的静态网站能通过 GitHub Pages 服务进行托管，而无需自己维护服务，更稳定、安全，因此我们需要上传 Hugo 生成的静态网页文件至 GitHub Page 项目仓库。</p><h4 id=手动发布>手动发布</h4><p>当我们编辑博客内容并通过 <code>hugo server</code> 本地调试后，就可以通过 <code>hugo</code> 命令生成静态网页文件了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo
</span></span><span class=line><span class=cl><span class=nb>cd</span> public/
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/hugo_gen_pages.png alt=hugo_gen_pages></p><p>Hugo 默认会将生成的静态网页文件存放在 <code>public/</code> 目录下，我们可以通过将 <code>public/</code> 目录初始化为 git 仓库并关联我们的 <code>pseudoyu/pseudoyu.github.io</code> 远程仓库来推送我们的网页静态文件。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git init
</span></span><span class=line><span class=cl>git remote add origin git@github.com:pseudoyu/pseudoyu.github.io
</span></span><span class=line><span class=cl>git add .
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;add test&#34;</span>
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/hugo_public_init.png alt=hugo_public_init></p><p>核对文件修改后，即可通过 <code>git push origin master</code> 推送到 GitHub Pages 仓库，稍等几分钟即可通过我们的自定义域名来访问我们的博客站点了，和我们 <code>hugo server</code> 本地调试完全一致。</p><h4 id=自动发布>自动发布</h4><p>通过上述命令我们可以手动发布我们的静态文件，但还是有以下弊端：</p><ol><li>发布步骤还是比较繁琐，本地调试后还需要切换到 <code>public/</code> 目录进行上传</li><li>无法对博客 <code>.md</code> 源文件进行备份与版本管理</li></ol><p>因此，我们需要简单顺滑的方式来进行博客发布，首先我们初始化博客源文件的仓库，如我的仓库为 <a href=https://github.com/pseudoyu/yu-blog>pseudoyu/yu-blog</a>。</p><p>因为我们的博客基于 GitHub 与 GitHub Pages，可以通过官方提供的 GitHub Action 进行 CI 自动发布，下面我会进行详细讲解。GitHub Action 是一个持续集成和持续交付(CI/CD) 平台，可用于自动执行构建、测试和部署管道，目前已经有很多开发好的工作流，可以通过简单的配置即可直接使用。</p><p>配置在仓库目录 <code>.github/workflows</code> 下，以 <code>.yml</code> 为后缀。我的 GitHub Action 配置为 <a href=https://github.com/pseudoyu/yu-blog/blob/master/.github/workflows/deploy.yml>pseudoyu/yu-blog deploy.yml</a>，自动发布示例配置如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>workflow_dispatch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>schedule</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c># Runs everyday at 8:00 AM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>cron</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0 0 * * *&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Checkout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>submodules</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>fetch-depth</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-hugo@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;latest&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build Web</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy Web</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-gh-pages@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>PERSONAL_TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.PERSONAL_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>EXTERNAL_REPOSITORY</span><span class=p>:</span><span class=w> </span><span class=l>pseudoyu/pseudoyu.github.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>PUBLISH_BRANCH</span><span class=p>:</span><span class=w> </span><span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>PUBLISH_DIR</span><span class=p>:</span><span class=w> </span><span class=l>./public</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>commit_message</span><span class=p>:</span><span class=w> </span><span class=l>${{ github.event.head_commit.message }}</span><span class=w>
</span></span></span></code></pre></div><p><code>on</code> 表示 GitHub Action 触发条件，我设置了 <code>push</code>、<code>workflow_dispatch</code> 和 <code>schedule</code> 三个条件：</p><ul><li><code>push</code>，当这个项目仓库发生推送动作后，执行 GitHub Action</li><li><code>workflow_dispatch</code>，可以在 GitHub 项目仓库的 Action 工具栏进行手动调用</li><li><code>schedule</code>，定时执行 GitHub Action，如我的设置为北京时间每天早上执行，主要是使用一些自动化统计 CI 来自动更新我博客的关于页面，如本周编码时间，影音记录等，如果你不需要定时功能，可以删除这个条件</li></ul><p><code>jobs</code> 表示 GitHub Action 中的任务，我们设置了一个 <code>build</code> 任务，<code>runs-on</code> 表示 GitHub Action 运行环境，我们选择了 <code>ubuntu-latest</code>。我们的 <code>build</code> 任务包含了 <code>Checkout</code>、<code>Setup Hugo</code>、<code>Build Web</code> 和 <code>Deploy Web</code> 四个主要步骤，其中 <code>run</code> 是执行的命令，<code>uses</code> 是 GitHub Action 中的一个插件，我们使用了 <code>peaceiris/actions-hugo@v2</code> 和 <code>peaceiris/actions-gh-pages@v3</code> 这两个插件。其中 <code>Checkout</code> 步骤中 <code>with</code> 中配置 <code>submodules</code> 值为 <code>true</code> 可以同步博客源仓库的子模块，即我们的主题模块。</p><p>首先需要将上述 <code>deploy.yml</code> 中的 <code>EXTERNAL_REPOSITORY</code> 改为自己的 GitHub Pages 仓库，如我的设置为 <code>pseudoyu/pseudoyu.github.io</code>。</p><p>因为我们需要从博客仓库推送到外部 GitHub Pages 仓库，需要特定权限，要在 GitHub 账户下 <code>Setting - Developer setting - Personal access tokens</code> 下创建一个 Token。</p><p><img src=https://image.pseudoyu.com/images/github_psersonal_access_token.png alt=github_psersonal_access_token></p><p>权限需要开启 <code>repo</code> 与 <code>workflow</code>。</p><p><img src=https://image.pseudoyu.com/images/yu_blog_personal_token.png alt=yu_blog_personal_token></p><p>配置后复制生成的 Token（注：只会出现一次），然后在我们博客源仓库的 <code>Settings - Secrets - Actions</code> 中添加 <code>PERSONAL_TOKEN</code> 环境变量为刚才的 Token，这样 GitHub Action 就可以获取到 Token 了。</p><p>完成上述配置后，推送代码至仓库，即可触发 GitHub Action，自动生成博客页面并推送至 GitHub Pages 仓库。</p><p><img src=https://image.pseudoyu.com/images/yu_blog_ci.png alt=yu_blog_ci></p><p>而 GitHub Pages 仓库更新后，又会自动触发官方页面部署 CI，实现我们的网站发布。</p><p><img src=https://image.pseudoyu.com/images/page_build_ci.png alt=page_build_ci></p><p>经过上述配置，我们已经实现了 Hugo 博客本地搭建及版本管理、GitHub Pages 部署网站发布，Hugp 主题管理及更新等功能，实现了完整的系统。现在每当我们本地通过熟悉的 Markdown 语法完成博客内容编辑后，只需要推送代码，等待几分钟，即可通过我们的自定义域名访问更新后的网站。</p><h3 id=组件拓展>组件拓展</h3><p>一个完整的博客系统还需要一些组件，如网站数据统计、评论系统等，我针对这两个核心需求也写了完整的 Serverless 搭建教程，可根据需求进行部署配置。</p><ul><li><a href=https://www.pseudoyu.com/zh/2022/05/21/free_blog_analysis_using_umami_vercel_and_heroku/>从零开始搭建一个免费的个人博客数据统计系统（umami + Vercel + Heroku）</a></li><li><a href=https://www.pseudoyu.com/zh/2022/05/24/free_and_lightweight_blog_comment_system_using_cusdis_and_railway/>轻量级开源免费博客评论系统解决方案 （Cusdis + Railway）</a></li></ul><h2 id=总结>总结</h2><p>以上就是我通过 Hugo 与 GitHub Action 实现的免费博客自动部署系统，我自己的实现仓库在 <a href=https://github.com/pseudoyu/yu-blog>pseudoyu/yu-blog</a> 仓库中，我定制化的主题仓库在 <a href=https://github.com/pseudoyu/hugo-theme-den>pseudoyu/hugo-theme-den</a> 中。</p><p>我使用 GitHub Action 还实现了很多好玩的自动化个人统计功能，自动更新我的<a href=https://github.com/pseudoyu>GitHub Profile</a>，项目仓库为 <a href=https://github.com/pseudoyu/pseudoyu>pseudoyu/pseudoyu</a>，可以进入 <code>.github/workflows</code> 中自行探索。这些系统还在不断完善中，欢迎大家参与贡献与交流。</p><h2 id=参考资料>参考资料</h2><blockquote><ol><li><a href=https://gohugo.io>Hugo 官网</a></li><li><a href=https://github.com/features/actions>GitHub Action</a></li><li><a href=https://pages.github.com>GitHub Pages</a></li><li><a href=https://www.cloudflare.com>Cloudflare 官网</a></li><li><a href=https://www.pseudoyu.com/zh/2022/03/24/free_blog_deploy_using_hugo_and_cusdis/>免费的个人博客系统搭建及部署解决方案（Hugo + GitHub Pages + Cusdis）</a></li><li><a href=https://www.pseudoyu.com/zh/2022/05/21/free_blog_analysis_using_umami_vercel_and_heroku/>从零开始搭建一个免费的个人博客数据统计系统（umami + Vercel + Heroku）</a></li><li><a href=https://www.pseudoyu.com/zh/2022/05/24/free_and_lightweight_blog_comment_system_using_cusdis_and_railway/>轻量级开源免费博客评论系统解决方案 （Cusdis + Railway）</a></li><li><a href=https://www.pseudoyu.com>我的 Pseudoyu 个人博客</a></li><li><a href=https://github.com/pseudoyu>我的 GitHub Profile</a></li></ol></blockquote></articl><h2>相关文章</h2><dl class=row></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2022-06-12</dt><dd class=col-md-9><a href=/zh/2022/06/12/why_i_still_write_blog_in_2022/>2022 年了，聊聊我为什么还在写博客</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2022-05-29</dt><dd class=col-md-9><a href=/zh/2022/05/29/deploy_ghost_5_on_digital_ocean_vps/>Ghost 5.0 来了，使用 Digital Ocean 一键部署吧</a></dd></dl></dl></dl></dl></dl><dt class=col-md-3>2022-05-24</dt><dd class=col-md-9><a href=/zh/2022/05/24/free_and_lightweight_blog_comment_system_using_cusdis_and_railway/>轻量级开源免费博客评论系统解决方案 （Cusdis + Railway）</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2022-05-21</dt><dd class=col-md-9><a href=/zh/2022/05/21/free_blog_analysis_using_umami_vercel_and_heroku/>从零开始搭建一个免费的个人博客数据统计系统（umami + Vercel + Heroku）</a></dd></dl></dl></dl></dl></dl><dt class=col-md-3>2022-03-24</dt><dd class=col-md-9><a href=/zh/2022/03/24/free_blog_deploy_using_hugo_and_cusdis/>免费的个人博客系统搭建及部署解决方案（Hugo + GitHub Pages + Cusdis）</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><div class=author-card><div class=underline></div><div class=author-box><div class=author-image><a href=https://www.pseudoyu.com><img src=/images/author.webp alt=pseudoyu></a></div><div class=author-content><p class=author-title>作者</p><p class=author-name>pseudoyu</p><p class=author-desc>后端 & 智能合约研发工程师，HKU ECICer。喜欢探索新技术，空闲时也折腾 Logseq 等效率工具。 在 <a href=https://github.com/pseudoyu>GitHub</a> 关注我。在我的 <a href=https://t.me/pseudoyulife>Telegram 频道</a>了解更多。</p></div></div></div><div align=center><div class=comment-underline></div></div><br><div class=comments><div class=title><span>Comments</span>
<span class=counter><span class=remark42__counter data-url=https://www.pseudoyu.com/zh/2022/05/29/deploy_your_blog_using_hugo_and_github_action/></span></span></div><div id=remark42></div></div><script>var remark_config={host:"https://comments.pseudoyu.com",site_id:"pseudoyu.com",components:["embed","counter"],max_shown_comments:20,simple_view:!0,theme:"light"}</script><script>(function(){const t=window.REMARK42;if(t)t.destroy(),t.createInstance(remark_config);else for(const t of remark_config.components){var n=document,e=n.createElement("script");e.src=`${remark_config.host}/web/${t}.mjs`,e.type="module",e.defer=!0,e.setAttribute("data-no-instant",""),n.head.appendChild(e)}})()</script></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>网站地图</div><ul class=list-unstyled><li><a href=https://www.pseudoyu.com/zh/tags/>标签</a></li><li><a href=https://www.pseudoyu.com/zh/categories/>分类</a></li><li><a rel=alternate type=application/rss+xml href=https://www.pseudoyu.com/zh/index.xml><i class="fas fa-rss-square"></i> RSS</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>社交</div><ul class=list-unstyled><li><a href=https://t.me/pseudoyulife rel=noopener target=_blank>Telegram</a></li><li><a href=https://twitter.com/pseudo_yu rel=noopener target=_blank>Twitter</a></li><li><a href=https://www.instagram.com/pseudo.yu/ rel=noopener target=_blank>Instagram</a></li><li><a href=https://space.bilibili.com/5374948/ rel=noopener target=_blank>BiliBili</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>关于</div><ul class=list-unstyled><li><a href=https://github.com/pseudoyu rel=noopener target=_blank>Yu's GitHub</a></li><li><a href=https://uptime.pseudoyu.com/status/services rel=noopener target=_blank>Yu's Services</a></li></ul></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em><a href=https://data.pseudoyu.com/share/8YKX7FUa/pseudoyu-blog rel=noopener target=_blank>Yu's blog analytics</a></em></small><br><small><em>Powered by <a href=https://gohugo.io rel=noopener target=_blank>Hugo</a> - <a href=https://github.com/shaform/hugo-theme-den rel=noopener target=_blank>den</a></em></small><br><small><em><a href=https://www.hku.hk rel=noopener target=_blank>The University of Hong Kong</a> - <a href=https://www.cs.hku.hk rel=noopener target=_blank>CS</a></em></small><br><small>&copy;
Yu Zhang
2020 -
2024</small></p></div><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" id=scroll-top class=scroll-top accesskey=g><span class=arrow-icon></span></a>
<script>var mybutton=document.getElementById("scroll-top");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script></body></html>