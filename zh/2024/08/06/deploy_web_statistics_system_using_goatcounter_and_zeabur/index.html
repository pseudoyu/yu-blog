<!doctype html><html lang=zh itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.105.0"><meta charset=utf-8><title>使用 GoatCounter 与 Zeabur 搭建网站数据统计系统 · Pseudoyu</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script data-goatcounter=https://stats.pseudoyu.com/count async src=//stats.pseudoyu.com/count.js></script><meta name=description content="前言 在「2024 年了，我的博客有了什么变化」一文中，我介绍了自己使用 Serverless 平台和一些开源项目搭建的博客系统，也开启了这个系列教程来记录搭建和部署"><meta name=keywords content="hugo,blockchain,programming"><link rel=canonical href=https://www.pseudoyu.com/zh/2024/08/06/deploy_web_statistics_system_using_goatcounter_and_zeabur/><link rel=alternate href=https://www.pseudoyu.com/en/2024/08/06/deploy_web_statistics_system_using_goatcounter_and_zeabur/ hreflang=en><link rel=alternate href=https://www.pseudoyu.com/de/2024/08/06/deploy_web_statistics_system_using_goatcounter_and_zeabur/ hreflang=de><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href=https://www.pseudoyu.com/css/den.css><link rel=stylesheet href=https://www.pseudoyu.com/css/custom.css><meta property="og:title" content="使用 GoatCounter 与 Zeabur 搭建网站数据统计系统"><meta property="og:description" content="前言 在「2024 年了，我的博客有了什么变化」一文中，我介绍了自己使用 Serverless 平台和一些开源项目搭建的博客系统，也开启了这个系列教程来记录搭建和部署"><meta property="og:type" content="article"><meta property="og:url" content="https://www.pseudoyu.com/zh/2024/08/06/deploy_web_statistics_system_using_goatcounter_and_zeabur/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-06T19:00:42+08:00"><meta property="article:modified_time" content="2024-08-06T19:00:42+08:00"><meta itemprop=name content="使用 GoatCounter 与 Zeabur 搭建网站数据统计系统"><meta itemprop=description content="前言 在「2024 年了，我的博客有了什么变化」一文中，我介绍了自己使用 Serverless 平台和一些开源项目搭建的博客系统，也开启了这个系列教程来记录搭建和部署"><meta itemprop=datePublished content="2024-08-06T19:00:42+08:00"><meta itemprop=dateModified content="2024-08-06T19:00:42+08:00"><meta itemprop=wordCount content="3182"><meta itemprop=keywords content="statistic-system,serverless,zeabur,blog,goatcounter,"><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 GoatCounter 与 Zeabur 搭建网站数据统计系统"><meta name=twitter:description content="前言 在「2024 年了，我的博客有了什么变化」一文中，我介绍了自己使用 Serverless 平台和一些开源项目搭建的博客系统，也开启了这个系列教程来记录搭建和部署"></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://www.pseudoyu.com/images/background.png);background-position:50%;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://www.pseudoyu.com/zh/><img class="mr20 header-logo-image" src=https://www.pseudoyu.com/images/icon.png alt=logo>
Pseudoyu</a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/category/ideas/>思考</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/category/tools/>工具</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/category/develop/>编程</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/links/>友链</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/about/>关于</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/search/>搜索</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/><i class="fas fa-globe"></i> EN</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/de/><i class="fas fa-globe"></i> DE</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>使用 GoatCounter 与 Zeabur 搭建网站数据统计系统</h1><p class=header-date>作者:
pseudoyu
| <span>3182 字, 7 分钟</span>
| <span class=remark42__counter data-url=https://www.pseudoyu.com/zh/2024/08/06/deploy_web_statistics_system_using_goatcounter_and_zeabur/></span> 评论
| 2024-08-06
| 分类:
<a href=https://www.pseudoyu.com/zh/category/tools/>Tools</a></p><div class=header-underline></div><div class=clearfix></div><p class="float-right header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://www.pseudoyu.com/zh/tag/blog/>blog</a>,
<a href=https://www.pseudoyu.com/zh/tag/goatcounter/>goatcounter</a>,
<a href=https://www.pseudoyu.com/zh/tag/serverless/>serverless</a>,
<a href=https://www.pseudoyu.com/zh/tag/statistic-system/>statistic-system</a>,
<a href=https://www.pseudoyu.com/zh/tag/zeabur/>zeabur</a></p><div class=clearfix></div><p class="float-right translations"><i class="fas fa-language" aria-hidden=true></i>
翻译:
<a href=https://www.pseudoyu.com/en/2024/08/06/deploy_web_statistics_system_using_goatcounter_and_zeabur/>EN</a>, <a href=https://www.pseudoyu.com/de/2024/08/06/deploy_web_statistics_system_using_goatcounter_and_zeabur/>DE</a></p></div></div></div></div></div><main><div class="container content"><articl data-pagefind-body><h2 id=前言>前言</h2><p>在「<a href=https://www.pseudoyu.com/zh/2024/06/29/what_changed_in_my_blog_2024/>2024 年了，我的博客有了什么变化</a>」一文中，我介绍了自己使用 Serverless 平台和一些开源项目搭建的博客系统，也开启了这个系列教程来记录搭建和部署全过程。</p><p>本篇是关于统计系统的解决方案。</p><h2 id=统计系统方案>统计系统方案</h2><p>相比起博客本体和评论系统，我在很长的一段时间其实都没有在意过统计系统（<del>主要当时也没人看</del>），更加没考虑太多 SEO 或是什么其他推广方向上的事，但后来逐渐发现，其实统计下来的数据并不只是一张好看的可以用来发推的图表，其对于博客的选题、内容都有着很大的参考价值。</p><p>其实主流成熟的方案都能够满足基本的需求，即使是免费的 Google Analytics 也完全够用，但在博客发展过程中，我依然因各种原因有过几次迭代，最终使用了 GoatCounter 这一方案。</p><h3 id=splitbee>splitbee</h3><p>我最初使用的是一个免费的工具 splitbee，它提供了免费的基础统计额度，有着还不错的界面，并且还支持一些复杂的用户追踪，A/B test 等，但印象里好像只能保留半年的数据，并且每月超过 5000 pv 后就需要升级了，所以后来放弃了。</p><h3 id=cloudflare--google-search-console>Cloudflare + Google Search Console</h3><p><img src=https://image.pseudoyu.com/images/cloudflare_web_stats.png alt=cloudflare_web_stats></p><p>放弃 splitbee 之后，很长一段时间我没有集成额外的统计应用，而是用的 Cloudflare 自带的站点统计，但是发现它其实统计的只是网络总流量，有包括爬虫在内的非常多的无效数据，并且没有精确到路径等细节。</p><p><img src=https://image.pseudoyu.com/images/google_search_console.png alt=google_search_console></p><p>后来了解到了 SEO 这一概念后，又添加了 <a href=https://search.google.com/search-console/about>Google Search Console</a> 这一统计维度，这也是目前觉得对我写博文最有意义的数据，主要呈现的是用户在搜索引擎中触达我博客站点的关键词以及通过搜索点击进入我博客的页面路径。</p><p>可以看到，一篇「<a href=https://www.pseudoyu.com/zh/category/tools/>Warp，iTerm2 还是 Alacritty？我的终端折腾小记</a>」为我带来了许多访客，而关于博客搭建、智能合约开发也是大部分从搜索引擎来的自然用户对我博客的第一印象。</p><h3 id=umami--supabase--netlify>Umami + Supabase + Netlify</h3><p><img src=https://image.pseudoyu.com/images/yu_umami_record.png alt=yu_umami_record></p><p>但是上述两者依然只能看到网站整体的数据，想精确到某篇文章在一段时间的表现或者文章发布后的实时访问数据，依然需要一个统计系统，我在看了 Reorx 的一篇「<a href=https://reorx.com/blog/deploy-umami-for-personal-website/>搭建 umami 收集个人网站统计数据 | Reorx’s Forge</a>」选择使用了 umami 这一开源、易自部署的统计系统，界面简洁，功能易用，很方便集成到自己的博客系统中。</p><p>使用了一年半，一直倒没出现什么问题，，只不过可能因为自己用得比较早，在一次大版本更新的时候数据库 Migration 脚本出现了不兼容的字段更新，其实有点不理解这样量级的开源项目为什么会出现这样的问题，也看到 issue 中有很多其他用户有同样的诉求，但最终并没有给出一个比较好的解决方案。</p><p>但其实最大的问题是一个统计系统依赖了两个平台，部署和维护上都还是有些太重了。当数据库或是 Netlify 任一出现问题或需要迁移时，会带来许多额外的成本。于是前段时间在更新博客评论系统的时候，想着干脆就一起更换为更轻量的 GoatCounter。</p><h3 id=goatcounter--zeabur>GoatCounter + Zeabur</h3><p><img src=https://image.pseudoyu.com/images/goatcounter_stats.png alt=goatcounter_stats></p><p>这个小众的统计系统是我在看 Reorx 的博客代码更新的时候偶然发现的，一下子被这种 Retro Internet 的风格所吸引，几乎没有任何多余的按钮，功能却很完备，而且使用的是 go 单二进制文件 + sqlite 数据库单文件的架构，轻量而易于部署，于是打算迁移。</p><p>其实我自己的 GoatCounter 是部署在 <a href=https://fly.io/>fly.io</a> 上的，但我在上一篇 Remark42 的文章中已经非常详细地介绍了 fly 的操作说明，不想有太多重复，刚好最近又在重度使用 <a href="https://zeabur.com?referralCode=pseudoyu">Zeabur</a> 这一 Serverless 平台，于是本文将以 <a href="https://zeabur.com?referralCode=pseudoyu">Zeabur</a> 为例，方式同样适用于其他类似平台。</p><p>我也在下文的 Zeabur 部署方案之后提供了 fly.io 和在 VPS 上使用 docker-compose 部署的配置文件，供大家参考。</p><h2 id=goatcounter-部署说明>GoatCounter 部署说明</h2><p>GoatCounter 本身代码开源 —— 「<a href=https://github.com/arp242/goatcounter>GitHub - arp242/goatcounter</a>」，文档清晰易读，可以根据自己的实际需求进行配置。GoatCounter + Zeabur 的方案仅牵扯到单个服务，数据库使用的是 sqlite 挂载于 volume 中，所以部署起来非常简单。</p><h3 id=使用-zeabur-部署>使用 Zeabur 部署</h3><p><a href="https://zeabur.com?referralCode=pseudoyu">Zeabur</a> 对于容器应用的部署是需要 Developer Plan 的，5 美元/月，但是像这样的镜像服务整体用量和费用都较低，每月的额度足够部署非常多服务，可以酌情选择。整体部署流程比起 fly.io 简单很多，所有操作都可以使用 Web 界面完成，不需要额外安装命令行工具等。</p><h4 id=注册-zeabur>注册 zeabur</h4><p><img src=https://image.pseudoyu.com/images/zeabur_login.png alt=zeabur_login></p><p>访问 <a href="https://zeabur.com?referralCode=pseudoyu">Zeabur</a> 官网，并点击右上角，使用 GitHub 账号授权登录。</p><h4 id=创建新项目>创建新项目</h4><p><img src=https://image.pseudoyu.com/images/zeabur_new_project.png alt=zeabur_new_project></p><p>进入主界面后，点击右上角 <code>创建项目</code> 按钮。</p><p><img src=https://image.pseudoyu.com/images/zeabur_hk_region.png alt=zeabur_hk_region></p><p>我选择了香港的 AWS 机房，不同机房的访问速度、性能和价格会有一些差异，可以根据自己的需求进行选择。</p><h4 id=配置镜像部署>配置镜像部署</h4><p><img src=https://image.pseudoyu.com/images/zeabur_build.png alt=zeabur_build></p><p>在下一步中选择 Docker 容器镜像进行部署。</p><p><img src=https://image.pseudoyu.com/images/zeabur_docker_custom_config.png alt=zeabur_docker_custom_config></p><p>由于我们使用的是自己构建的镜像，官方也没有上线 GoatCounter 模板，因此我们点击选择自定义。</p><p><img src=https://image.pseudoyu.com/images/zeabur_prebuilt_edit_toml.png alt=zeabur_prebuilt_edit_toml></p><p>这一步可以自己在界面上填写各种配置项，但可能由于我习惯了 fly.io 的文件配置模式，我选择左下角的 <code>编辑 TOML 文件</code>，大家也可以直接复制我的配置文件并直接修改。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;yu-goatcounter&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>source</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>image</span> <span class=p>=</span> <span class=s2>&#34;pseudoyu/goatcounter&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[[</span><span class=nx>ports</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=nx>id</span> <span class=p>=</span> <span class=s2>&#34;web&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>port</span> <span class=p>=</span> <span class=mi>8080</span>
</span></span><span class=line><span class=cl><span class=nx>type</span> <span class=p>=</span> <span class=s2>&#34;HTTP&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[[</span><span class=nx>volumes</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=nx>id</span> <span class=p>=</span> <span class=s2>&#34;goatcounter-data&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dir</span> <span class=p>=</span> <span class=s2>&#34;/data&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>env</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>PORT</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>default</span> <span class=p>=</span> <span class=s2>&#34;8080&#34;</span> <span class=p>,</span> <span class=nx>expose</span> <span class=p>=</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>GOATCOUNTER_DB</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>default</span> <span class=p>=</span> <span class=s2>&#34;sqlite3://data/goatcounter.sqlite3&#34;</span> <span class=p>,</span> <span class=nx>expose</span> <span class=p>=</span> <span class=kc>true</span> <span class=p>}</span>
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/zeabur_prebuilt_goatcounter_toml.png alt=zeabur_prebuilt_goatcounter_toml></p><p>配置好后点击右下角部署按钮即可。</p><h4 id=部署完成>部署完成</h4><p><img src=https://image.pseudoyu.com/images/yu-goatcounter_project.png alt=yu-goatcounter_project></p><p>点击部署后，等待片刻，会有一个生成的项目默认名称，可以在左上角的设置中去修改为可读性较强的名称，如 <code>yu-goatcounter</code>。</p><h4 id=配置自定义域名>配置自定义域名</h4><p><img src=https://image.pseudoyu.com/images/zeabur_create_domain.png alt=zeabur_create_domain></p><p>服务部署完成后，我们需要进行域名绑定才能通过公网访问网站，Zeabur 提供了免费的二级域名 <code>xx.zeabur.app</code>，也可以绑定自己的域名。</p><p><img src=https://image.pseudoyu.com/images/zeabur_custom_domain.png alt=zeabur_custom_domain></p><p>其中生成域名可直接使用，无须进行其他配置，如 <code>goatcounter.zeabur.app</code>；而如果使用的是自定义域名，则需要在自己域名管理后台添加 CNAME 记录，指向格式为 <code>xxx.cname.zeabur-dns.com</code> 的机房地址。</p><p><img src=https://image.pseudoyu.com/images/cloudflare_goatcounter_config.png alt=cloudflare_goatcounter_config></p><p>例如我的域名托管在 Cloudflare 上，添加的 CNAME 记录如上图所示，有去问过官方，说如果选 AWS HK 机房的话可以不使用 Cloudflare 的代理，速度理论上会更快，可以根据自己的需要酌情配置。</p><p>此外，如果你选择的是华为云机房，则需要域名备案并且额外新增一条 TXT 记录，可以根据提示进行操作。</p><p><img src=https://image.pseudoyu.com/images/zeabur_custom_domain_success.png alt=zeabur_custom_domain_success></p><p>显示绿色则为配置成功，至此我们的 GoatCounter 服务就部署完成了。</p><h4 id=数据备份>数据备份</h4><p>我们在配置时候有这么一段</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[[</span><span class=nx>volumes</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=nx>id</span> <span class=p>=</span> <span class=s2>&#34;goatcounter-data&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dir</span> <span class=p>=</span> <span class=s2>&#34;/data&#34;</span>
</span></span></code></pre></div><p>功能是将容器内的 <code>/data</code> 目录（即我们的 sqlite 数据库存在的位置）挂载到一个 id 为 <code>goatcounter-data</code> 的存储卷，如果不挂载存储卷的话，容器重启或重新部署数据将会丢失。</p><p>关于存储卷这一点 Zeabur 的界面上没有很直观的显示和管理操作，以至于我总是怀疑自己的配置是否生效。</p><p><img src=https://image.pseudoyu.com/images/zeabur_add_goatcounter_backup.png alt=zeabur_add_goatcounter_backup></p><p>研究了半天发现可以先在设置中暂停服务，然后在上面的备份模块新增一个备份，点击下载后可以在本地看到我们备份文件，目录层级如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>data/
</span></span><span class=line><span class=cl>└── goatcounter-data
</span></span><span class=line><span class=cl>    └── goatcounter.sqlite3
</span></span></code></pre></div><p>这样则能表示我们的数据成功持久化了，希望 Zeabur 能在界面上有更直观的显示。</p><h3 id=使用-flyio-部署>使用 fly.io 部署</h3><p>纯免费的方案依然可以参照我提到的这篇「<a href=https://www.pseudoyu.com/zh/2024/07/22/free_commenting_system_using_remark42_and_flyio/>从零开始搭建你的免费博客评论系统（Remark42 + fly.io）</a>」，仅在 <code>fly.toml</code> 配置部分不同，我也提供的我所使用的配置文件 —— 「<a href=https://github.com/pseudoyu/goatcounter-on-fly/blob/master/fly.toml>fly.toml</a>」供大家参考。</p><h3 id=使用-docker-与-docker-compose-部署>使用 Docker 与 docker-compose 部署</h3><p>有意思的是，因为 goatcounter 的作者很有坚持，觉得这样单文件的应用容器化反而会增加更多维护成本，所以不提供官方镜像，不过自己在 vps 或者 serverless 平台部署有个镜像还是方便一些，所以我使用 Github Actions 做了一个构建镜像和上传 Docker Hub 的 CI，有需要的可以使用，对应的 Dockerfile 和 Docker Compose 文件也可以参照这个 <a href=https://github.com/pseudoyu/goatcounter/commit/b98de9873ee331133a39b409fd4bb00cf55c8a05>Commit</a>，或者直接使用 <code>pseudoyu/goatcounter</code> 和 <code>docker-compose.yml</code> 文件即可。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>goatcounter</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>pseudoyu/goatcounter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>8080</span><span class=p>:</span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>PORT=8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>GOATCOUNTER_DB=sqlite3://data/goatcounter.sqlite3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./data:/data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span></code></pre></div><h2 id=goatcounter-配置说明>GoatCounter 配置说明</h2><p>上文我们完成了 GoatCounter 服务的部署，现在就可以通过我们生成/自定义的域名访问到我们的统计系统服务了，如我是通过 <code>https://goatcounter.pseudoyu.com</code> 进行访问的。</p><p><img src=https://image.pseudoyu.com/images/goatcounter_create_user.png alt=goatcounter_create_user></p><p>第一次登录需要创建一个用户，填写邮箱、密码点击 <code>Create</code> 即可。</p><p><img src=https://image.pseudoyu.com/images/goatcounter_dashboard_success.png alt=goatcounter_dashboard_success></p><p>登录成功后，当前还没有数据，会提示一个脚本，后续在我们博客使用的配置中会用到。</p><h2 id=博客配置-goatcounter>博客配置 GoatCounter</h2><p>跟着上文我们完成了 GoatCounter 服务的部署和基础配置，现在则需要在我们的博文中加入统计组件，以我使用的 Hugo 博客为例。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>data-goatcounter</span><span class=o>=</span><span class=s>&#34;https://goatcounter.pseudoyu.com/count&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>async</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;//goatcounter.pseudoyu.com/count.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/add_goatcounter_script_in_hugo.png alt=add_goatcounter_script_in_hugo></p><p>将上述代码加到我 hugo 主题的 <code>head</code> 中即可，如我的 Hugo 主题在 <code>layouts/partials/head.html</code> 这一文件，不同主题或是不同 SSG 框架位置有所不同但大同小异。</p><p>有一点要注意的是， goatcounter 会忽略来自 <code>localhost</code> 的请求以避免在本地预览时造成太多脏数据，因此在本地调试时是看不到数据的，需要部署网页才能看到访问数据。</p><p><img src=https://image.pseudoyu.com/images/final_display_of_goatcounter.png alt=final_display_of_goatcounter></p><p>收集了数据后的效果大致如上图所示，还可以在 GoatCounter 界面中设置一些配置项、新增网页、查看详细数据等，包括还可以显示每个页面的访问计数等，可以自己根据文档进行探索。</p><h2 id=总结>总结</h2><p>至此我们的博客统计系统就搭建完成了！本文是我的博客搭建部署系列教程之一，博客主题体部分都已经完成了，剩下只是一些例如博客内搜索等细节体验优化，希望能对大家有所参考。</p></articl><h2>相关文章</h2><dl class=row></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2024-07-22</dt><dd class=col-md-9><a href=/zh/2024/07/22/free_commenting_system_using_remark42_and_flyio/>从零开始搭建你的免费博客评论系统（Remark42 + fly.io）</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2024-07-02</dt><dd class=col-md-9><a href=/zh/2024/07/02/protect_your_image_using_webp_and_cloudflare_waf/>使用 WebP Cloud 与 Cloudflare WAF 为你的图床添加隐私和版权保护</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2024-06-30</dt><dd class=col-md-9><a href=/zh/2024/06/30/free_image_hosting_system_using_r2_webp_cloud_and_picgo/>从零开始搭建你的免费图床系统（Cloudflare R2 + WebP Cloud + PicGo）</a></dd></dl><dt class=col-md-3>2024-06-29</dt><dd class=col-md-9><a href=/zh/2024/06/29/what_changed_in_my_blog_2024/>2024 年了，我的博客有了什么变化</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2024-03-24</dt><dd class=col-md-9><a href=/zh/2024/03/24/weekly_review_20240324/>周报 #55 - 油画体验、博客系统升级与对 self-hosting 的思考</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><div class=author-card><div class=underline></div><div class=author-box><div class=author-image><a href=https://www.pseudoyu.com><img src=/images/author.webp alt=pseudoyu></a></div><div class=author-content><p class=author-title>作者</p><p class=author-name>pseudoyu</p><p class=author-desc>后端 & 智能合约研发工程师，HKU ECICer。喜欢探索新技术，空闲时也折腾博客搭建、效率工具等。 在 <a href=https://github.com/pseudoyu>GitHub</a> 关注我。在我的 <a href=https://t.me/pseudoyulife>Telegram 频道</a>了解更多。</p></div></div></div><div align=center><div class=comment-underline></div></div><br><div class=comments><div class=title><span>Comments</span>
<span class=counter><span class=remark42__counter data-url=https://www.pseudoyu.com/zh/2024/08/06/deploy_web_statistics_system_using_goatcounter_and_zeabur/></span></span></div><div id=remark42></div></div><script>var remark_config={host:"https://comments.pseudoyu.com",site_id:"pseudoyu.com",components:["embed","counter"],max_shown_comments:20,simple_view:!0,theme:"light"}</script><script>(function(){const t=window.REMARK42;if(t)t.destroy(),t.createInstance(remark_config);else for(const t of remark_config.components){var n=document,e=n.createElement("script");e.src=`${remark_config.host}/web/${t}.mjs`,e.type="module",e.defer=!0,e.setAttribute("data-no-instant",""),n.head.appendChild(e)}})()</script></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>网站地图</div><ul class=list-unstyled><li><a href=https://www.pseudoyu.com/zh/tags/>标签</a></li><li><a href=https://www.pseudoyu.com/zh/categories/>分类</a></li><li><a rel=alternate type=application/rss+xml href=https://www.pseudoyu.com/zh/index.xml><i class="fas fa-rss-square"></i> RSS</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>社交</div><ul class=list-unstyled><li><a href=https://t.me/pseudoyulife rel=noopener target=_blank>Telegram</a></li><li><a href=https://twitter.com/pseudo_yu rel=noopener target=_blank>Twitter</a></li><li><a href=https://www.instagram.com/pseudo.yu/ rel=noopener target=_blank>Instagram</a></li><li><a href=https://space.bilibili.com/5374948/ rel=noopener target=_blank>BiliBili</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>关于</div><ul class=list-unstyled><li><a href=https://github.com/pseudoyu rel=noopener target=_blank>Yu's GitHub</a></li></ul></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em><a href="https://stats.pseudoyu.com?access-token=2m1u5i2k413q0733h2a3332w3m1t6r634g1m6n" rel=noopener target=_blank>Yu's blog analytics</a></em></small><br><small><em>Powered by <a href=https://gohugo.io rel=noopener target=_blank>Hugo</a> - <a href=https://github.com/shaform/hugo-theme-den rel=noopener target=_blank>den</a></em></small><br><small><em><a href=https://www.hku.hk rel=noopener target=_blank>The University of Hong Kong</a> - <a href=https://www.cs.hku.hk rel=noopener target=_blank>CS</a></em></small><br><small>&copy;
Yu Zhang
2020 -
2024</small></p></div><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" id=scroll-top class=scroll-top accesskey=g><span class=arrow-icon></span></a>
<script>var mybutton=document.getElementById("scroll-top");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script></body></html>