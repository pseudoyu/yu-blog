<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.105.0"><meta charset=utf-8><title>How I Rescued Critical Data When My Cloud Server Crashed · Pseudoyu</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script data-goatcounter=https://stats.pseudoyu.com/count async src=//stats.pseudoyu.com/count.js></script><meta name=description content="Preface On Friday, my 2C2G server purchased from BandwagonHost suddenly reported a kernel error, making it impossible to connect via SSH or restart. After a series of circuitous rescue attempts, I finally managed to salvage over a thousand images from my image hosting service. Still shaken by the experience, I&amp;rsquo;d like to document the rescue process and, incidentally, discuss the new image hosting solution I&amp;rsquo;ve set up.
Server Rescue This server had been running stably for about a year and a half, hosting many of my critical services, including over a thousand irreplaceable images for my blog&amp;rsquo;s image hosting service, persistently stored on the host via Docker Volume."><meta name=keywords content="hugo,blockchain,programming"><link rel=canonical href=https://www.pseudoyu.com/en/2024/07/01/rescue_my_data_from_a_crashed_server/><link rel=alternate href=https://www.pseudoyu.com/zh/2024/07/01/rescue_my_data_from_a_crashed_server/ hreflang=zh><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href=https://www.pseudoyu.com/css/den.css><link rel=stylesheet href=https://www.pseudoyu.com/css/custom.css><meta property="og:title" content="How I Rescued Critical Data When My Cloud Server Crashed"><meta property="og:description" content="Preface On Friday, my 2C2G server purchased from BandwagonHost suddenly reported a kernel error, making it impossible to connect via SSH or restart. After a series of circuitous rescue attempts, I finally managed to salvage over a thousand images from my image hosting service. Still shaken by the experience, I&rsquo;d like to document the rescue process and, incidentally, discuss the new image hosting solution I&rsquo;ve set up.
Server Rescue This server had been running stably for about a year and a half, hosting many of my critical services, including over a thousand irreplaceable images for my blog&rsquo;s image hosting service, persistently stored on the host via Docker Volume."><meta property="og:type" content="article"><meta property="og:url" content="https://www.pseudoyu.com/en/2024/07/01/rescue_my_data_from_a_crashed_server/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-01T15:30:00+08:00"><meta property="article:modified_time" content="2024-07-01T15:30:00+08:00"><meta itemprop=name content="How I Rescued Critical Data When My Cloud Server Crashed"><meta itemprop=description content="Preface On Friday, my 2C2G server purchased from BandwagonHost suddenly reported a kernel error, making it impossible to connect via SSH or restart. After a series of circuitous rescue attempts, I finally managed to salvage over a thousand images from my image hosting service. Still shaken by the experience, I&rsquo;d like to document the rescue process and, incidentally, discuss the new image hosting solution I&rsquo;ve set up.
Server Rescue This server had been running stably for about a year and a half, hosting many of my critical services, including over a thousand irreplaceable images for my blog&rsquo;s image hosting service, persistently stored on the host via Docker Volume."><meta itemprop=datePublished content="2024-07-01T15:30:00+08:00"><meta itemprop=dateModified content="2024-07-01T15:30:00+08:00"><meta itemprop=wordCount content="1050"><meta itemprop=keywords content="vps,server,vps,linux,serverless,self-hosting,"><meta name=twitter:card content="summary"><meta name=twitter:title content="How I Rescued Critical Data When My Cloud Server Crashed"><meta name=twitter:description content="Preface On Friday, my 2C2G server purchased from BandwagonHost suddenly reported a kernel error, making it impossible to connect via SSH or restart. After a series of circuitous rescue attempts, I finally managed to salvage over a thousand images from my image hosting service. Still shaken by the experience, I&rsquo;d like to document the rescue process and, incidentally, discuss the new image hosting solution I&rsquo;ve set up.
Server Rescue This server had been running stably for about a year and a half, hosting many of my critical services, including over a thousand irreplaceable images for my blog&rsquo;s image hosting service, persistently stored on the host via Docker Volume."></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://www.pseudoyu.com/images/background.webp);background-position:50%;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://www.pseudoyu.com/en/><img class="mr20 header-logo-image" src=https://image.pseudoyu.com/images/fly.png alt=logo>
Pseudoyu</a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/category/ideas/>Idea</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/category/tools/>Tool</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/category/develop/>Develop</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/links/>Links</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/about/>About</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/search/>Search</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/><i class="fas fa-globe"></i> 中文</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>How I Rescued Critical Data When My Cloud Server Crashed</h1><p class=header-date>Author:
pseudoyu
| <span>1050 words, 5 minutes</span>
| <span class=remark42__counter data-url=https://www.pseudoyu.com/en/2024/07/01/rescue_my_data_from_a_crashed_server/></span> comments
| 2024-07-01
| Category:
<a href=https://www.pseudoyu.com/en/category/develop/>Develop</a></p><div class=header-underline></div><div class=clearfix></div><p class="float-right header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://www.pseudoyu.com/en/tag/linux/>linux</a>,
<a href=https://www.pseudoyu.com/en/tag/self-hosting/>self-hosting</a>,
<a href=https://www.pseudoyu.com/en/tag/server/>server</a>,
<a href=https://www.pseudoyu.com/en/tag/serverless/>serverless</a>,
<a href=https://www.pseudoyu.com/en/tag/vps/>vps</a>,
<a href=https://www.pseudoyu.com/en/tag/vps/>vps</a></p><div class=clearfix></div><p class="float-right translations"><i class="fas fa-language" aria-hidden=true></i>
Translations:
<a href=https://www.pseudoyu.com/zh/2024/07/01/rescue_my_data_from_a_crashed_server/>ZH</a></p></div></div></div></div></div><main><div class="container content"><articl data-pagefind-body><h2 id=preface>Preface</h2><p>On Friday, my 2C2G server purchased from BandwagonHost suddenly reported a kernel error, making it impossible to connect via SSH or restart. After a series of circuitous rescue attempts, I finally managed to salvage over a thousand images from my image hosting service. Still shaken by the experience, I&rsquo;d like to document the rescue process and, incidentally, discuss the new image hosting solution I&rsquo;ve set up.</p><h2 id=server-rescue>Server Rescue</h2><p>This server had been running stably for about a year and a half, hosting many of my critical services, including over a thousand irreplaceable images for my blog&rsquo;s image hosting service, persistently stored on the host via Docker Volume.</p><h3 id=server-downtime>Server Downtime</h3><p>To this day, I&rsquo;m still uncertain about what exactly went wrong. That morning, I needed to update the image version of my RSSHub instance running on the server. I thought I might as well update all services to their latest versions. So, I ran a series of <code>docker pull</code> and <code>docker-compose</code> restart operations. Everything seemed fine until the last service suddenly failed to start its container, reporting an error similar to <code>not enough space</code>. I assumed that downloading too many images might have filled up the disk, so I ran a series of <code>docker image prune --all</code>, <code>docker volume prune</code>, and <code>docker system prune</code> commands, freeing up nearly 10GB of space. I tried again, but it still didn&rsquo;t work.</p><p>As a developer with only a smidgen of server maintenance experience, my first instinct was to restart. Little did I know, this would mark the beginning of a day-long nightmare.</p><p><img src=https://image.pseudoyu.com/images/uptime_kuma_status.png alt=uptime_kuma_status></p><p>After the restart, my Uptime Kuma alerted me that all services were offline, and I could no longer connect to the machine via SSH.</p><p><img src=https://image.pseudoyu.com/images/bwg_kernel_panic.jpg alt=bwg_kernel_panic></p><p>I quickly logged into BandwagonHost&rsquo;s online console, only to discover a kernel error preventing startup. Even a forced restart proved ineffective. I immediately submitted a support ticket and reached out to my DevOps friends for help.</p><h3 id=data-rescue>Data Rescue</h3><p><img src=https://image.pseudoyu.com/images/ask_strrl_about_vps.png alt=ask_strrl_about_vps></p><p>STRRL suggested that there might be an issue with the <code>rootfs</code>. However, given that this small cloud provider doesn&rsquo;t offer advanced boot options or other additional features, we could only wait for official technical support. Still, the thought of losing a year and a half&rsquo;s worth of unbackup image hosting data made me anxious, so I started looking for ways to rescue the data.</p><p><img src=https://image.pseudoyu.com/images/bwg_vps_snapshot.png alt=bwg_vps_snapshot></p><p>After investigating BandwagonHost&rsquo;s console, I found that they provide weekly backups that can be instantly converted into snapshots. The most recent one was from June 22nd, which was fortunate. My first thought was to restore the machine directly from the snapshot. If today&rsquo;s operations had caused some configuration issue, then a snapshot from a week ago should boot normally. Full of hope, I waited about ten minutes for the snapshot restoration, only to encounter the same error. Still not giving up, I tried restoring the June 15th backup as well, but to no avail.</p><p>At this point, I realized the gravity of the situation and even prepared for the worst-case scenario of losing all data. While waiting for a response to my support ticket, I started searching for similar cases and eventually discovered that BandwagonHost&rsquo;s snapshot images can be downloaded. I found an article titled &ldquo;Tutorial on downloading, unzipping, and viewing data from BandwagonHost backup snapshot image files .tar.gz and .disk files.&rdquo;</p><p>So, I downloaded the snapshot image and obtained a <code>.disk</code> file. This file seemed to be in a proprietary format. According to the tutorial, it can be converted using Virtual Box&rsquo;s command-line tool <code>vboxmanage convertfromraw</code>. However, after downloading from the official website, I found it doesn&rsquo;t support M-chip Macs. So, I installed and executed the conversion on my old 2019 Intel Mac, resulting in a <code>.vmdk</code> file.</p><p>After the conversion, I mounted this <code>.vmdk</code> as a disk on a Virtual Box CentOS virtual machine, only to encounter the same error.</p><p><img src=https://image.pseudoyu.com/images/7zip_format.png alt=7zip_format></p><p>So, I tried a different approach and found that the <a href=https://arc.net/l/quote/tirhqejc>7-Zip</a> software supports extracting common virtual machine formats, but the client is only available for Windows.</p><p><img src=https://image.pseudoyu.com/images/x7z_vmdk_x.jpg alt=x7z_vmdk_x></p><p>Although theoretically, I could use the command-line version <a href=https://github.com/p7zip-project/p7zip>p7zip</a> on macOS, I encountered errors during extraction. So, that avenue was blocked too. I came up with a roundabout solution: I downloaded a Win11 virtual machine, installed the 7-Zip software, and successfully extracted the files.</p><p><img src=https://image.pseudoyu.com/images/fuse_load_img.png alt=fuse_load_img></p><p>Another problem arose: the resulting files were Linux disk image files in <code>1.img</code>, <code>2.img</code> format, which couldn&rsquo;t be loaded on macOS. I asked my company&rsquo;s operations team, tried fiddling with fuse, but still couldn&rsquo;t load them.</p><p><img src=https://image.pseudoyu.com/images/ufs_load_img_log.jpg alt=ufs_load_img_log></p><p>There was some good news during this time. While scouring the internet, I discovered a data recovery software called UFS Explorer. I tried it and found it could load the files normally, except that files over 768k required a paid version. Of course, I didn&rsquo;t intend to pay, but seeing that the files were indeed readable gave me peace of mind. At least the data was there; the rest was just a technical problem.</p><p><img src=https://image.pseudoyu.com/images/bwg_reply.png alt=bwg_reply></p><p>Meanwhile, BandwagonHost responded to my ticket, suggesting I try restarting or reinstalling&mldr; 🤣</p><p><img src=https://image.pseudoyu.com/images/str_orbstack_img.png alt=str_orbstack_img></p><p>Giving up on ticket communication, I continued trying to rescue my data from the <code>img</code> file. The ever-resourceful STRRL told me that OrbStack can start a Linux Machine, and I could mount this <code>img</code> as a Linux disk.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo losetup -fP 1.img
</span></span><span class=line><span class=cl>mkdir /mnt/bwg
</span></span><span class=line><span class=cl>sudo mount /dev/loop0 /mnt/bwg
</span></span></code></pre></div><p>Using these commands, I successfully mounted my <code>img</code> disk image to the OrbStack Ubuntu machine.</p><p><img src=https://image.pseudoyu.com/images/rescue_image_from_bwg_img.png alt=rescue_image_from_bwg_img></p><p>When I saw my images appear in the command line output, I was almost moved to tears 😭.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tar -czvf cheverto_chevereto_images.tar.gz cheverto_chevereto_images/
</span></span><span class=line><span class=cl>rsync -acvP ./cheverto_chevereto_images.tar.gz pseudoyu@<span class=o>[</span>yu-mac-studio<span class=o>]</span>:~/Downloads/
</span></span></code></pre></div><p><img src=https://image.pseudoyu.com/images/rsync_service.jpg alt=rsync_service></p><p>I quickly created a <code>tar</code> package and transferred it to my local Mac using <code>rsync</code>. After extracting it locally, I finally saw all my images.</p><h3 id=migrating-the-image-hosting-system-to-r2>Migrating the Image Hosting System to r2</h3><p>However, due to this experience, I no longer trust the stability of server-based image hosting. I spent half a day setting up a new free image hosting system — &ldquo;Building Your Free Image Hosting System from Scratch (Cloudflare R2 + WebP Cloud + PicGo)&rdquo;.</p><p><img src=https://image.pseudoyu.com/images/rclone_service.jpg alt=rclone_service></p><p>As for uploading existing data to <code>r2</code>, I used <code>rclone</code> to complete the migration. Mission accomplished!</p><h2 id=conclusion>Conclusion</h2><p>I&rsquo;ve started reconsidering issues of service deployment and data security. I plan to move some important data to the cloud rather than relying on single machines, and continue migrating some services to serverless platforms like <a href=https://fly.io>fly.io</a> and <a href=https://zeabur.com/>Zeabur</a>.</p></articl><h2>Related Posts</h2><dl class=row></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><div class=author-card><div class=underline></div><div class=author-box><div class=author-image><a href=https://www.pseudoyu.com><img src=/images/author.webp alt=pseudoyu></a></div><div class=author-content><p class=author-title>Author</p><p class=author-name>pseudoyu</p><p class=author-desc>Backend & Smart Contract Developer, MSc Graduate in ECIC(Electronic Commerce and Internet Computing) @ The University of Hong Kong (HKU). Love to learn and build things. <a href=https://github.com/pseudoyu>Follow me on GitHub</a></p></div></div></div><div align=center><div class=comment-underline></div></div><br><div class=comments><div class=title><span>Comments</span>
<span class=counter><span class=remark42__counter data-url=https://www.pseudoyu.com/en/2024/07/01/rescue_my_data_from_a_crashed_server/></span></span></div><div id=remark42></div></div><script>var remark_config={host:"https://comments.pseudoyu.com",site_id:"pseudoyu.com",components:["embed","counter"],max_shown_comments:20,simple_view:!0,theme:"light"}</script><script>(function(){const t=window.REMARK42;if(t)t.destroy(),t.createInstance(remark_config);else for(const t of remark_config.components){var n=document,e=n.createElement("script");e.src=`${remark_config.host}/web/${t}.mjs`,e.type="module",e.defer=!0,e.setAttribute("data-no-instant",""),n.head.appendChild(e)}})()</script></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>Sitemap</div><ul class=list-unstyled><li><a href=https://www.pseudoyu.com/en/tags/>Tags</a></li><li><a href=https://www.pseudoyu.com/en/categories/>Categories</a></li><li><a rel=alternate type=application/rss+xml href=https://www.pseudoyu.com/en/index.xml><i class="fas fa-rss-square"></i> RSS Feed</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>Social</div><ul class=list-unstyled><li><a href=https://t.me/pseudoyulife rel=noopener target=_blank>Telegram</a></li><li><a href=https://twitter.com/pseudo_yu rel=noopener target=_blank>Twitter</a></li><li><a href=https://www.instagram.com/pseudo.yu/ rel=noopener target=_blank>Instagram</a></li><li><a href=https://space.bilibili.com/5374948/ rel=noopener target=_blank>BiliBili</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>Links</div><ul class=list-unstyled><li><a href=https://github.com/pseudoyu rel=noopener target=_blank>Yu's GitHub</a></li><li><a href=https://uptime.pseudoyu.com/status/services rel=noopener target=_blank>Yu's Services</a></li><li><a href=https://www.m1sty.com/ rel=noopener target=_blank>M1sty's Blog</a></li></ul></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em><a href="https://stats.pseudoyu.com?access-token=2m1u5i2k413q0733h2a3332w3m1t6r634g1m6n" rel=noopener target=_blank>Yu's blog analytics</a></em></small><br><small><em>Powered by <a href=https://gohugo.io rel=noopener target=_blank>Hugo</a> - <a href=https://github.com/shaform/hugo-theme-den rel=noopener target=_blank>den</a></em></small><br><small><em><a href=https://www.hku.hk rel=noopener target=_blank>The University of Hong Kong</a> - <a href=https://www.cs.hku.hk rel=noopener target=_blank>CS</a></em></small><br><small>&copy;
Yu Zhang
2020 -
2024</small></p></div><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" id=scroll-top class=scroll-top accesskey=g><span class=arrow-icon></span></a>
<script>var mybutton=document.getElementById("scroll-top");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script></body></html>