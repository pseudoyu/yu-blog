<!doctype html><html lang=de itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.105.0"><meta charset=utf-8><title>Solidity Smart Contract Entwicklung - Grundlagen · Pseudoyu</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script data-goatcounter=https://stats.pseudoyu.com/count async src=//stats.pseudoyu.com/count.js></script><meta name=description content="&amp;#39;Here After Us - Mayday&amp;#39; Vorwort Im letzten Jahr habe ich während meines Masterstudiums den Kurs &amp;ldquo;COMP7408 Distributed Ledger and Blockchain Technology&amp;rdquo; an der HKU belegt. In diesem Kurs lernte ich über die Entwicklung von Ethereum Smart Contracts und erstellte eine einfache Bibliotheksverwaltungs-ÐApp. Für mein Abschlussprojekt entschied ich mich, eine Musik-Copyright-Anwendung basierend auf Ethereum zu entwickeln, die unter Uright - Blockchain Music Copyright Management ÐApp zu finden ist. Durch diese Erfahrungen gewann ich ein grundlegendes Verständnis für die Solidity-Entwicklung."><meta name=keywords content="hugo,blockchain,programming"><link rel=canonical href=https://www.pseudoyu.com/de/2022/05/25/learn_solidity_from_scratch_basic/><link rel=alternate href=https://www.pseudoyu.com/zh/2022/05/25/learn_solidity_from_scratch_basic/ hreflang=zh><link rel=alternate href=https://www.pseudoyu.com/en/2022/05/25/learn_solidity_from_scratch_basic/ hreflang=en><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href=https://www.pseudoyu.com/css/den.css><link rel=stylesheet href=https://www.pseudoyu.com/css/custom.css><meta property="og:title" content="Solidity Smart Contract Entwicklung - Grundlagen"><meta property="og:description" content="'Here After Us - Mayday' Vorwort Im letzten Jahr habe ich während meines Masterstudiums den Kurs &ldquo;COMP7408 Distributed Ledger and Blockchain Technology&rdquo; an der HKU belegt. In diesem Kurs lernte ich über die Entwicklung von Ethereum Smart Contracts und erstellte eine einfache Bibliotheksverwaltungs-ÐApp. Für mein Abschlussprojekt entschied ich mich, eine Musik-Copyright-Anwendung basierend auf Ethereum zu entwickeln, die unter Uright - Blockchain Music Copyright Management ÐApp zu finden ist. Durch diese Erfahrungen gewann ich ein grundlegendes Verständnis für die Solidity-Entwicklung."><meta property="og:type" content="article"><meta property="og:url" content="https://www.pseudoyu.com/de/2022/05/25/learn_solidity_from_scratch_basic/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-25T01:07:33+08:00"><meta property="article:modified_time" content="2022-05-25T01:07:33+08:00"><meta itemprop=name content="Solidity Smart Contract Entwicklung - Grundlagen"><meta itemprop=description content="'Here After Us - Mayday' Vorwort Im letzten Jahr habe ich während meines Masterstudiums den Kurs &ldquo;COMP7408 Distributed Ledger and Blockchain Technology&rdquo; an der HKU belegt. In diesem Kurs lernte ich über die Entwicklung von Ethereum Smart Contracts und erstellte eine einfache Bibliotheksverwaltungs-ÐApp. Für mein Abschlussprojekt entschied ich mich, eine Musik-Copyright-Anwendung basierend auf Ethereum zu entwickeln, die unter Uright - Blockchain Music Copyright Management ÐApp zu finden ist. Durch diese Erfahrungen gewann ich ein grundlegendes Verständnis für die Solidity-Entwicklung."><meta itemprop=datePublished content="2022-05-25T01:07:33+08:00"><meta itemprop=dateModified content="2022-05-25T01:07:33+08:00"><meta itemprop=wordCount content="3303"><meta itemprop=keywords content="blockchain,ethereum,solidity,smart contract,web3,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Solidity Smart Contract Entwicklung - Grundlagen"><meta name=twitter:description content="'Here After Us - Mayday' Vorwort Im letzten Jahr habe ich während meines Masterstudiums den Kurs &ldquo;COMP7408 Distributed Ledger and Blockchain Technology&rdquo; an der HKU belegt. In diesem Kurs lernte ich über die Entwicklung von Ethereum Smart Contracts und erstellte eine einfache Bibliotheksverwaltungs-ÐApp. Für mein Abschlussprojekt entschied ich mich, eine Musik-Copyright-Anwendung basierend auf Ethereum zu entwickeln, die unter Uright - Blockchain Music Copyright Management ÐApp zu finden ist. Durch diese Erfahrungen gewann ich ein grundlegendes Verständnis für die Solidity-Entwicklung."></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://www.pseudoyu.com/images/background.png);background-position:50%;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://www.pseudoyu.com/de/><img class="mr20 header-logo-image" src=https://www.pseudoyu.com/images/icon.png alt=logo>
Pseudoyu</a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/de/category/ideas/>Ideen</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/de/category/tools/>Tools</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/de/category/develop/>Code</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/de/links/>Links</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/de/search/>Suche</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/de/about/>Über</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/zh/><i class="fas fa-globe"></i> 简</a></li><li class=nav-item><a class=nav-link href=https://www.pseudoyu.com/en/><i class="fas fa-globe"></i> EN</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>Solidity Smart Contract Entwicklung - Grundlagen</h1><p class=header-date>Autor:
pseudoyu
| <span>3303 Wörter, 16 Minuten</span>
| <span class=remark42__counter data-url=https://www.pseudoyu.com/de/2022/05/25/learn_solidity_from_scratch_basic/></span> Kommentare
| 2022-05-25
| Kategorie:
<a href=https://www.pseudoyu.com/de/category/develop/>Develop</a></p><div class=header-underline></div><div class=clearfix></div><p class="float-right header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://www.pseudoyu.com/de/tag/blockchain/>blockchain</a>,
<a href=https://www.pseudoyu.com/de/tag/ethereum/>ethereum</a>,
<a href=https://www.pseudoyu.com/de/tag/smart-contract/>smart contract</a>,
<a href=https://www.pseudoyu.com/de/tag/solidity/>solidity</a>,
<a href=https://www.pseudoyu.com/de/tag/web3/>web3</a></p><div class=clearfix></div><p class="float-right translations"><i class="fas fa-language" aria-hidden=true></i>
Übersetzungen:
<a href=https://www.pseudoyu.com/zh/2022/05/25/learn_solidity_from_scratch_basic/>ZH</a>, <a href=https://www.pseudoyu.com/en/2022/05/25/learn_solidity_from_scratch_basic/>EN</a></p></div></div></div></div></div><main><div class="container content"><articl data-pagefind-body><figure><audio controls preload=metadata><source src=/audios/here_after_us.mp3 type=audio/mpeg></audio><i><figcaption>'Here After Us - Mayday'</figcaption></i></figure><h2 id=vorwort>Vorwort</h2><p>Im letzten Jahr habe ich während meines Masterstudiums den Kurs &ldquo;COMP7408 Distributed Ledger and Blockchain Technology&rdquo; an der HKU belegt. In diesem Kurs lernte ich über die Entwicklung von Ethereum Smart Contracts und erstellte eine einfache Bibliotheksverwaltungs-ÐApp. Für mein Abschlussprojekt entschied ich mich, eine Musik-Copyright-Anwendung basierend auf Ethereum zu entwickeln, die unter <a href=https://github.com/pseudoyu/uright>Uright - Blockchain Music Copyright Management ÐApp</a> zu finden ist. Durch diese Erfahrungen gewann ich ein grundlegendes Verständnis für die Solidity-Entwicklung.</p><p>Nach Beginn meiner beruflichen Laufbahn konzentrierte ich mich hauptsächlich auf Consortium-Blockchain und Geschäftsentwicklung und hatte lange Zeit nicht mit Verträgen gearbeitet. Infolgedessen wurde mein Verständnis der Syntax und einiger zugrunde liegender Konzepte etwas vage. Kürzlich war ich an einem Projekt beteiligt, das auf einer EVM-kompatiblen Kette basiert und die Entwicklung grundlegender Verträge für Beweisspeicherung, -abruf und -migration umfasst. Das Debuggen dieser Verträge erwies sich als herausfordernd, weshalb ich beschloss, Solidity systematisch zu studieren. Indem ich meine Notizen in Artikeln organisiere, hoffe ich, mich selbst zu ermutigen, tief zu denken und effektiv zusammenzufassen.</p><p>Diese Artikelserie wird auch in mein persönliches Wissensbasis-Projekt &ldquo;Blockchain Beginner&rsquo;s Guide&rdquo; aufgenommen, das unter <a href=https://www.pseudoyu.com/blockchain-guide/>https://www.pseudoyu.com/blockchain-guide/</a> zu finden ist. Ich beabsichtige, diese Ressource kontinuierlich zu verbessern, während ich lerne. Für Interessierte können Sie das <a href=https://github.com/pseudoyu/blockchain-guide>Projekt-Repository</a> besuchen, um beizutragen oder Vorschläge zu machen.</p><p>Dieser Artikel ist der erste in der Serie und wird die grundlegenden Kenntnisse von Solidity behandeln.</p><h2 id=smart-contracts-und-die-solidity-sprache>Smart Contracts und die Solidity-Sprache</h2><p>Smart Contracts sind Programme, die auf der Blockchain laufen. Vertragsentwickler können Smart Contracts verwenden, um mit On-Chain-Assets und -Daten zu interagieren, während Benutzer Verträge über ihre On-Chain-Konten aufrufen können, um auf Assets und Daten zuzugreifen. Aufgrund der Eigenschaften der Blockchain, historische Aufzeichnungen in einer Kettenstruktur zu bewahren, Dezentralisierung und Unveränderlichkeit, bieten Smart Contracts im Vergleich zu traditionellen Anwendungen eine größere Fairness und Transparenz.</p><p>Da Smart Contracts jedoch mit der Blockchain interagieren müssen, verbrauchen Operationen wie Bereitstellung und Datenschreiben eine gewisse Menge an Gebühren. Die Kosten für Datenspeicherung und -änderung sind ebenfalls relativ hoch. Daher ist es bei der Gestaltung von Verträgen entscheidend, den Ressourcenverbrauch zu berücksichtigen. Darüber hinaus können reguläre Smart Contracts nach der Bereitstellung nicht mehr geändert werden, sodass bei der Vertragsgestaltung Sicherheit, Upgradefähigkeit und Erweiterbarkeit berücksichtigt werden müssen.</p><p>Solidity ist eine vertragsorientiertierte Hochsprache, die für die Implementierung von Smart Contracts entwickelt wurde. Sie läuft auf der EVM (Ethereum Virtual Machine) und hat eine Syntax ähnlich wie JavaScript. Sie ist derzeit die beliebteste Smart-Contract-Sprache und ist für diejenigen, die in die Blockchain- und Web3-Bereiche einsteigen, unerlässlich. Solidity bietet relativ umfassende Lösungen, um die oben genannten Probleme beim Schreiben von Verträgen anzugehen, die wir später im Detail besprechen werden.</p><h2 id=entwicklungs--und-debug-tools>Entwicklungs- und Debug-Tools</h2><p>Im Gegensatz zu herkömmlichen Programmiersprachen kann die Entwicklung von Solidity Smart Contracts oft nicht bequem direkt über eine IDE oder lokale Umgebung debuggt werden. Stattdessen erfordert sie eine Interaktion mit einem On-Chain-Knoten. Entwicklung und Debugging werden typischerweise nicht direkt auf dem Mainnet (der Kette, auf der echte Assets, Daten und Geschäfte residieren) durchgeführt, da dies hohe Transaktionsgebühren verursachen würde. Derzeit gibt es mehrere Hauptmethoden und Frameworks für Entwicklung und Debugging:</p><ol><li><p><a href=https://github.com/trufflesuite/truffle>Truffle</a>. Truffle ist ein sehr beliebtes JavaScript-Framework für die Solidity-Vertragsentwicklung. Es bietet eine vollständige Toolchain für Entwicklung, Test und Debugging und kann mit lokalen oder entfernten Netzwerken interagieren.</p></li><li><p><a href=https://github.com/eth-brownie/brownie>Brownie</a>. Brownie ist ein Python-basiertes Framework für die Solidity-Vertragsentwicklung. Es bietet praktische Toolchains für Debugging und Testen mit prägnanter Python-Syntax.</p></li><li><p><a href=https://github.com/NomicFoundation/hardhat>Hardhat</a>. Hardhat ist ein weiteres JavaScript-basiertes Entwicklungsframework, das ein sehr reichhaltiges Plugin-System bietet, geeignet für die Entwicklung komplexer Vertragsprojekte.</p></li></ol><p>Zusätzlich zu Entwicklungsframeworks ist es notwendig, mit einigen Tools vertraut zu sein, um besser mit Solidity arbeiten zu können:</p><ol><li><p><a href=https://remix.ethereum.org>Remix IDE</a>. Das Debugging kann mit dem von Ethereum bereitgestellten browserbasierten Remix-Entwicklungstool durchgeführt werden. Remix bietet eine vollständige IDE, Kompilierungstools, Bereitstellungs-Debugging-Testknoten-Umgebung, Konten usw., was es sehr bequem für Tests macht. Dies ist das Tool, das ich beim Lernen am meisten verwendet habe. Remix kann auch direkt mit Testnets und Mainnets über das MetaMask-Plugin interagieren, und einige Produktionsumgebungen verwenden es auch für Kompilierung und Bereitstellung.</p></li><li><p>Remix IDE ist nicht perfekt für Syntaxvorschläge, daher können Sie <a href=https://code.visualstudio.com>Visual Studio Code</a> mit der <a href="https://marketplace.visualstudio.com/items?itemName=juanblanco.solidity">Solidity</a>-Erweiterung für eine bessere Schreiberfahrung verwenden.</p></li><li><p><a href=https://metamask.io>MetaMask</a>. Eine häufig verwendete Wallet-Anwendung. Während der Entwicklung können Sie über das Browser-Plugin mit Testnets und Mainnets interagieren, was für Entwickler bequem zum Debuggen ist.</p></li><li><p><a href=https://trufflesuite.com/ganache/>Ganache</a>. Ganache ist ein Open-Source virtueller lokaler Knoten, der ein virtuelles Kettennetzwerk bereitstellt. Es kann mit verschiedenen Web3.js, Remix oder einigen Framework-Tools interagieren und eignet sich für lokales Debugging und Testen von Projekten einer bestimmten Größenordnung.</p></li><li><p><a href=https://infura.io>Infura</a>. Infura ist ein IaaS (Infrastructure as a Service) Produkt. Wir können unseren eigenen Ethereum-Knoten beantragen und über die von Infura bereitgestellte API interagieren, was für das Debugging bequem ist und näher an der Produktionsumgebung liegt.</p></li><li><p><a href=https://www.openzeppelin.com>OpenZeppelin</a>. OpenZeppelin bietet zahlreiche Vertragsentwicklungsbibliotheken und Anwendungen, die Sicherheit und Stabilität gewährleisten und gleichzeitig Entwicklern eine bessere Entwicklungserfahrung bieten und die Kosten für die Vertragsentwicklung reduzieren.</p></li></ol><h2 id=vertragskompilierung-und--bereitstellung>Vertragskompilierung und -bereitstellung</h2><p>Solidity-Verträge sind Dateien mit der Erweiterung <code>.sol</code> und können nicht direkt ausgeführt werden. Sie müssen in Bytecode kompiliert werden, der von der EVM (Ethereum Virtual Machine) erkannt werden kann, um auf der Kette zu laufen.</p><p><img src=https://image.pseudoyu.com/images/compile_solidity.png alt=compile_solidity></p><p>Nach der Kompilierung wird der Vertrag vom Vertragskonto auf die Kette bereitgestellt. Andere Konten können über Wallets mit dem Vertrag interagieren, um On-Chain-Geschäftslogik zu implementieren.</p><h2 id=kernsyntax>Kernsyntax</h2><p>Jetzt, da wir ein grundlegendes Verständnis für die Entwicklung, das Debugging und die Bereitstellung von Solidity haben, lassen Sie uns in die Kernsyntax von Solidity eintauchen.</p><h3 id=datentypen>Datentypen</h3><p>Wie gängige Programmiersprachen hat Solidity mehrere eingebaute Datentypen.</p><h4 id=grundlegende-datentypen>Grundlegende Datentypen</h4><ul><li><code>boolean</code>: Boolescher Typ hat zwei Werte, <code>true</code> und <code>false</code>. Er kann als <code>bool public boo = true;</code> definiert werden. Der Standardwert ist <code>false</code>.</li><li><code>int</code>: Ganzzahltyp, kann von <code>int8</code> bis <code>int256</code> spezifiziert werden, Standard ist <code>int256</code>. Er kann als <code>int public int = 0;</code> definiert werden. Der Standardwert ist <code>0</code>. Sie können auch <code>type(int).min</code> und <code>type(int).max</code> verwenden, um die Minimal- und Maximalwerte des Typs zu überprüfen.</li><li><code>uint</code>: Nicht-negativer Ganzzahltyp, kann als <code>uint8</code>, <code>uint16</code>, <code>uint256</code> spezifiziert werden, Standard ist <code>uint256</code>. Er kann als <code>uint8 public u8 = 1;</code> definiert werden. Der Standardwert ist <code>0</code>.</li><li><code>address</code>: Adresstyp, kann als <code>address public addr = 0xCA35b7d915458EF540aDe6068dFe2F44E8fa733c;</code> definiert werden. Der Standardwert ist <code>0x0000000000000000000000000000000000000000</code>.</li><li><code>bytes</code>: Abkürzung für <code>byte[]</code>, unterteilt in Arrays fester Größe und variable Arrays. Es kann als <code>bytes1 a = 0xb5;</code> definiert werden.</li></ul><p>Es gibt auch einige relativ komplexe Datentypen, die wir separat besprechen werden.</p><h4 id=enum>Enum</h4><p><code>Enum</code> ist ein Aufzählungstyp, der mit der folgenden Syntax definiert werden kann:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>enum</span> <span class=nc>Status</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Unknown</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Start</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>End</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Pause</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Er kann mit der folgenden Syntax aktualisiert und initialisiert werden:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// Enum-Typ instanziieren
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Status</span> <span class=k>public</span> <span class=n>status</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Enum-Wert aktualisieren
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nf>pause</span><span class=p>()</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span> <span class=o>=</span> <span class=n>Status</span><span class=p>.</span><span class=n>Pause</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Enum-Wert initialisieren
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nf>reset</span><span class=p>()</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>delete</span> <span class=n>status</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=arrays>Arrays</h4><p>Arrays sind geordnete Sammlungen von Elementen des gleichen Typs. Sie können als <code>uint[] public arr;</code> definiert werden. Sie können die Array-Größe im Voraus bei der Definition angeben, wie <code>uint[10] public myFixedSizeArr;</code>.</p><p>Beachten Sie, dass wir Arrays im Speicher erstellen können (die Unterschiede zwischen <code>memory</code> und <code>storage</code> werden später im Detail besprochen), aber sie müssen von fester Größe sein, wie <code>uint[] memory a = new uint[](5);</code>.</p><p>Array-Typen haben einige grundlegende Operationsmethoden, wie folgt:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// Array-Typ definieren
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>uint</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=k>public</span> <span class=n>arr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Daten hinzufügen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>arr</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=mi>7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Letztes Datenelement löschen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>arr</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Daten an einem bestimmten Index löschen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>delete</span> <span class=n>arr</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Array-Länge abrufen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>uint</span> <span class=n>len</span> <span class=o>=</span> <span class=n>arr</span><span class=p>.</span><span class=n>length</span><span class=p>;</span>
</span></span></code></pre></div><h4 id=mapping>Mapping</h4><p><code>mapping</code> ist ein Abbildungstyp, definiert mit <code>mapping(keyType => valueType)</code>, wobei der Schlüssel ein eingebauter Typ wie <code>bytes</code>, <code>int</code>, <code>string</code> oder Vertragstyp sein muss, während der Wert jeder Typ sein kann, wie z.B. verschachtelter <code>mapping</code>-Typ. Beachten Sie, dass <code>mapping</code>-Typen nicht iteriert werden können; wenn eine Iteration benötigt wird, müssen Sie den entsprechenden Index selbst implementieren.</p><p>Hier sind einige Operationen:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// Verschachtelten Mapping-Typ definieren
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>mapping</span><span class=p>(</span><span class=kt>string</span> <span class=o>=&gt;</span> <span class=kd>mapping</span><span class=p>(</span><span class=kt>string</span> <span class=o>=&gt;</span> <span class=kt>string</span><span class=p>))</span> <span class=n>nestedMap</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Wert setzen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>nestedMap</span><span class=p>[</span><span class=n>id</span><span class=p>][</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=s>&#34;0707&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Wert lesen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>string</span> <span class=nb>value</span> <span class=o>=</span> <span class=n>nestedMap</span><span class=p>[</span><span class=n>id</span><span class=p>][</span><span class=n>key</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Wert löschen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>delete</span> <span class=n>nestedMap</span><span class=p>[</span><span class=n>id</span><span class=p>][</span><span class=n>key</span><span class=p>];</span>
</span></span></code></pre></div><h4 id=struct>Struct</h4><p><code>struct</code> ist ein Strukturtyp. Für komplexe Geschäfte müssen wir oft unsere eigenen Strukturen definieren, um verwandte Daten zu kombinieren. Es kann innerhalb eines Vertrags definiert werden:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>Struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>struct</span> <span class=nc>Data</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>hash</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Data</span> <span class=k>public</span> <span class=nb>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Daten hinzufügen
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>function</span> <span class=nf>create</span><span class=p>(</span><span class=kt>string</span> <span class=n>calldata</span> <span class=n>_id</span><span class=p>)</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>data</span> <span class=o>=</span> <span class=n>Data</span><span class=p>{</span><span class=n>id</span><span class=o>:</span> <span class=n>_id</span><span class=p>,</span> <span class=n>hash</span><span class=o>:</span> <span class=s>&#34;111222&#34;</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Daten aktualisieren
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>function</span> <span class=nf>update</span><span class=p>(</span><span class=kt>string</span> <span class=n>_id</span><span class=p>)</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Daten abfragen
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>string</span> <span class=n>id</span> <span class=o>=</span> <span class=nb>data</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Aktualisieren
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nb>data</span><span class=p>.</span><span class=n>hash</span> <span class=o>=</span> <span class=s>&#34;222333&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Sie können auch alle erforderlichen Strukturtypen in einer separaten Datei definieren und sie nach Bedarf in den Vertrag importieren:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// &#39;StructDeclaration.sol&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>struct</span> <span class=nc>Data</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>string</span> <span class=n>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>string</span> <span class=n>hash</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// &#39;Struct.sol&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;./StructDeclaration.sol&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>Struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Data</span> <span class=k>public</span> <span class=nb>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=variablen-konstanten-und-immutable>Variablen, Konstanten und <code>Immutable</code></h3><p>Variablen sind Datenstrukturen in Solidity, deren Werte sich ändern können. Es gibt drei Typen:</p><ul><li><code>local</code> Variablen</li><li><code>state</code> Variablen</li><li><code>global</code> Variablen</li></ul><p><code>local</code> Variablen werden innerhalb von Methoden definiert und werden nicht auf der Kette gespeichert, wie <code>string var = "Hello";</code>. <code>state</code> Variablen werden außerhalb von Methoden definiert und werden auf der Kette gespeichert. Sie werden als <code>string public var;</code> definiert. Das Schreiben eines Wertes sendet eine Transaktion, während das Lesen eines Wertes dies nicht tut. <code>global</code> Variablen sind globale Variablen, die Ketteninformationen bereitstellen, wie die aktuelle Block-Timestamp-Variable <code>uint timestamp = block.timestamp;</code> und die Vertragsaufrufer-Adressvariable <code>address sender = msg.sender;</code>.</p><p>Variablen können mit verschiedenen Schlüsselwörtern deklariert werden, um verschiedene Speicherorte anzuzeigen.</p><ul><li><code>storage</code>: Auf der Kette gespeichert</li><li><code>memory</code>: Im Speicher, existiert nur, wenn die Methode aufgerufen wird</li><li><code>calldata</code>: Existiert, wenn als Parameter zum Aufruf einer Methode übergeben</li></ul><p>Konstanten sind Variablen, deren Werte nicht geändert werden können. Die Verwendung von Konstanten kann Gasgebühren sparen. Wir können sie mit <code>string public constant MY_CONSTANT = "0707";</code> definieren. <code>immutable</code> ist ein spezieller Typ, dessen Wert im <code>constructor</code> initialisiert werden kann, aber nicht wieder geändert werden kann. Flexible Verwendung dieser Typen kann effektiv Gasgebühren sparen und Datensicherheit gewährleisten.</p><h3 id=funktionen>Funktionen</h3><p>In Solidity werden Funktionen verwendet, um spezifische Geschäftslogik zu definieren.</p><h4 id=berechtigungsdeklaration>Berechtigungsdeklaration</h4><p>Funktionen haben unterschiedliche Sichtbarkeiten, die mit verschiedenen Schlüsselwörtern deklariert werden:</p><ul><li><code>public</code>: Kann von jedem Vertrag aufgerufen werden</li><li><code>private</code>: Kann nur innerhalb des Vertrags aufgerufen werden, der die Methode definiert hat</li><li><code>internal</code>: Kann nur in geerbten Verträgen aufgerufen werden</li><li><code>external</code>: Kann nur von anderen Verträgen und Konten aufgerufen werden</li></ul><p>Vertragsfunktionen, die Daten abfragen, haben auch unterschiedliche Deklarationsmethoden:</p><ul><li><code>view</code> kann Variablen lesen, aber nicht modifizieren</li><li><code>pure</code> kann weder Variablen lesen noch modifizieren</li></ul><h4 id=funktionsmodifikatoren>Funktionsmodifikatoren</h4><p><code>modifier</code> Funktionsmodifikatoren können vor/nach dem Ausführen einer Funktion aufgerufen werden, hauptsächlich verwendet für Zugriffssteuerung, Eingabeparametervalidierung und Verhinderung von Wiedereintrittangriffen. Diese drei Arten von Modifikatoren können mit der folgenden Syntax definiert werden:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>modifier</span> <span class=nf>onlyOwner</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span> <span class=o>==</span> <span class=n>owner</span><span class=p>,</span> <span class=s>&#34;Not owner&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>modifier</span> <span class=nf>validAddress</span><span class=p>(</span><span class=kt>address</span> <span class=n>_addr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=n>_addr</span> <span class=o>!=</span> <span class=kt>address</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=s>&#34;Not valid address&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>modifier</span> <span class=nf>noReentrancy</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=o>!</span><span class=n>locked</span><span class=p>,</span> <span class=s>&#34;No reentrancy&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>locked</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>locked</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Um Funktionsmodifikatoren zu verwenden, müssen Sie den entsprechenden Modifikator bei der Deklaration der Funktion hinzufügen, wie zum Beispiel:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>function</span> <span class=nf>changeOwner</span><span class=p>(</span><span class=kt>address</span> <span class=n>_newOwner</span><span class=p>)</span> <span class=k>public</span> <span class=n>onlyOwner</span> <span class=n>validAddress</span><span class=p>(</span><span class=n>_newOwner</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>owner</span> <span class=o>=</span> <span class=n>_newOwner</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nf>decrement</span><span class=p>(</span><span class=kt>uint</span> <span class=n>i</span><span class=p>)</span> <span class=k>public</span> <span class=n>noReentrancy</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>-=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>decrement</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=funktionsselektor>Funktionsselektor</h4><p>Wenn eine Funktion aufgerufen wird, müssen die ersten vier Bytes der <code>calldata</code> angegeben werden, um zu bestätigen, welche Funktion aufgerufen werden soll. Dies wird als Funktionsselektor bezeichnet.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=n>addr</span><span class=p>.</span><span class=nb>call</span><span class=p>(</span><span class=nb>abi</span><span class=p>.</span><span class=nb>encodeWithSignature</span><span class=p>(</span><span class=s>&#34;transfer(address,uint256)&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=n>xSomeAddress</span><span class=p>,</span> <span class=mi>123</span><span class=p>))</span>
</span></span></code></pre></div><p>Die ersten vier Bytes des Rückgabewerts von <code>abi.encodeWithSignature()</code> im obigen Code sind der Funktionsselektor. Wenn wir den Funktionsselektor vor der Ausführung vorberechnen, können wir einige Gasgebühren sparen.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>FunctionSelector</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>getSelector</span><span class=p>(</span><span class=kt>string</span> <span class=n>calldata</span> <span class=n>_func</span><span class=p>)</span> <span class=k>external</span> <span class=k>pure</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>bytes4</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kt>bytes4</span><span class=p>(</span><span class=nb>keccak256</span><span class=p>(</span><span class=kt>bytes</span><span class=p>(</span><span class=n>_func</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=bedingungs--und-schleifenstrukturen>Bedingungs- und Schleifenstrukturen</h3><h4 id=bedingungen>Bedingungen</h4><p>Solidity verwendet die Schlüsselwörter <code>if</code>, <code>else if</code>, <code>else</code>, um bedingte Logik zu implementieren:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>&lt;</span> <span class=mi>20</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Eine Kurzform kann auch verwendet werden:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=n>x</span> <span class=o>&lt;</span> <span class=mi>20</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>:</span> <span class=mi>2</span><span class=p>;</span>
</span></span></code></pre></div><h4 id=schleifen>Schleifen</h4><p>Solidity verwendet die Schlüsselwörter <code>for</code>, <code>while</code>, <code>do while</code>, um Schleifenlogik zu implementieren, aber weil die letzten beiden dazu neigen, den <code>gas limit</code> Grenzwert zu erreichen, werden sie selten verwendet.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=kt>uint</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Geschäftslogik
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kt>uint</span> <span class=n>j</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>j</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=verträge>Verträge</h3><h4 id=konstruktor>Konstruktor</h4><p>Der <code>constructor</code> von Solidity kann bei der Erstellung eines Vertrags ausgeführt werden, hauptsächlich zur Initialisierung verwendet.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>constructor</span><span class=p>(</span><span class=kt>string</span> <span class=k>memory</span> <span class=n>_name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>name</span> <span class=o>=</span> <span class=n>_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Wenn es eine Vererbungsbeziehung zwischen Verträgen gibt, wird der <code>constructor</code> auch der Vererbungsreihenfolge folgen.</p><h4 id=schnittstelle>Schnittstelle</h4><p><code>Interface</code> wird verwendet, um mit Verträgen zu interagieren, indem Schnittstellen deklariert werden. Es hat folgende Anforderungen:</p><ul><li>Kann keine Methoden implementieren</li><li>Kann von anderen Schnittstellen erben</li><li>Alle Methoden müssen als <code>external</code> deklariert werden</li><li>Kann keinen Konstruktor deklarieren</li><li>Kann keine Zustandsvariablen deklarieren</li></ul><p>Eine Schnittstelle wird mit der folgenden Syntax definiert:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>Counter</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint</span> <span class=k>public</span> <span class=n>count</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>increment</span><span class=p>()</span> <span class=k>external</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>count</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>ICounter</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>count</span><span class=p>()</span> <span class=k>external</span> <span class=k>view</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>uint</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>increment</span><span class=p>()</span> <span class=k>external</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Sie kann wie folgt aufgerufen werden:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>MyContract</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>incrementCounter</span><span class=p>(</span><span class=kt>address</span> <span class=n>_counter</span><span class=p>)</span> <span class=k>external</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ICounter</span><span class=p>(</span><span class=n>_counter</span><span class=p>).</span><span class=n>increment</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>getCount</span><span class=p>(</span><span class=kt>address</span> <span class=n>_counter</span><span class=p>)</span> <span class=k>external</span> <span class=k>view</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>uint</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>ICounter</span><span class=p>(</span><span class=n>_counter</span><span class=p>).</span><span class=n>count</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=vererbung>Vererbung</h4><p>Solidity-Verträge unterstützen Vererbung und können gleichzeitig von mehreren Verträgen erben, indem sie das Schlüsselwort <code>is</code> verwenden.</p><p>Funktionen können überschrieben werden. Methoden, die geerbt werden sollen, sollten als <code>virtual</code> deklariert werden, und überschreibende Methoden sollten das Schlüsselwort <code>override</code> verwenden.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// Elternvertrag A definieren
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>contract</span> <span class=nc>A</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>foo</span><span class=p>()</span> <span class=k>public</span> <span class=k>pure</span> <span class=k>virtual</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>string</span> <span class=k>memory</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;A&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// Vertrag B erbt von Vertrag A und überschreibt die Funktion
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>contract</span> <span class=nc>B</span> <span class=k>is</span> <span class=n>A</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>foo</span><span class=p>()</span> <span class=k>public</span> <span class=k>pure</span> <span class=k>virtual</span> <span class=k>override</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>string</span> <span class=k>memory</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;B&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Vertrag D erbt von Verträgen B und C und überschreibt die Funktion
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>contract</span> <span class=nc>D</span> <span class=k>is</span> <span class=n>B</span><span class=p>,</span> <span class=n>C</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>foo</span><span class=p>()</span> <span class=k>public</span> <span class=k>pure</span> <span class=k>override</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>C</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>string</span> <span class=k>memory</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>super</span><span class=p>.</span><span class=n>foo</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Es gibt einige Punkte zu beachten: Die Reihenfolge der Vererbung wird die Geschäftslogik beeinflussen, und <code>state</code>-Variablen können nicht geerbt werden.</p><p>Wenn ein Kindvertrag seinen Elternvertrag aufrufen möchte, kann er neben dem direkten Aufruf auch das Schlüsselwort <code>super</code> verwenden, wie folgt:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>B</span> <span class=k>is</span> <span class=n>A</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>foo</span><span class=p>()</span> <span class=k>public</span> <span class=k>virtual</span> <span class=k>override</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Direkter Aufruf
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>A</span><span class=p>.</span><span class=n>foo</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>bar</span><span class=p>()</span> <span class=k>public</span> <span class=k>virtual</span> <span class=k>override</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Aufruf mit dem super Schlüsselwort
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nb>super</span><span class=p>.</span><span class=n>bar</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=vertragserstellung>Vertragserstellung</h4><p>In Solidity können Sie einen anderen Vertrag von einem Vertrag aus mit dem Schlüsselwort <code>new</code> erstellen.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>function</span> <span class=nf>create</span><span class=p>(</span><span class=kt>address</span> <span class=n>_owner</span><span class=p>,</span> <span class=kt>string</span> <span class=k>memory</span> <span class=n>_model</span><span class=p>)</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Car</span> <span class=n>car</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Car</span><span class=p>(</span><span class=n>_owner</span><span class=p>,</span> <span class=n>_model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cars</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>car</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Nach Solidity 0.8.0 wird die <code>create2</code>-Funktion für die Erstellung von Verträgen unterstützt:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>function</span> <span class=nf>create2</span><span class=p>(</span><span class=kt>address</span> <span class=n>_owner</span><span class=p>,</span> <span class=kt>string</span> <span class=k>memory</span> <span class=n>_model</span><span class=p>,</span> <span class=kt>bytes32</span> <span class=n>_salt</span><span class=p>)</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Car</span> <span class=n>car</span> <span class=o>=</span> <span class=p>(</span><span class=k>new</span> <span class=n>Car</span><span class=p>){</span><span class=n>salt</span><span class=o>:</span> <span class=n>_salt</span><span class=p>}(</span><span class=n>_owner</span><span class=p>,</span> <span class=n>_model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cars</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>car</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=importieren-von-verträgenexternen-bibliotheken>Importieren von Verträgen/externen Bibliotheken</h4><p>In komplexen Geschäftsszenarien benötigen wir oft mehrere Verträge, die zusammenarbeiten. In diesem Fall können wir das Schlüsselwort <code>import</code> verwenden, um Verträge zu importieren. Es gibt zwei Möglichkeiten: lokaler Import <code>import "./Foo.sol";</code> und externer Import <code>import "https://github.com/owner/repo/blob/branch/path/to/Contract.sol";</code>.</p><p>Externe Bibliotheken ähneln Verträgen, können aber keine Zustandsvariablen deklarieren und keine Assets senden. Wenn alle Methoden der Bibliothek <code>internal</code> sind, werden sie in den Vertrag eingebettet. Wenn sie nicht <code>internal</code> sind, muss die Bibliothek im Voraus bereitgestellt und verknüpft werden.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>library</span> <span class=n>SafeMath</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>add</span><span class=p>(</span><span class=kt>uint</span> <span class=n>x</span><span class=p>,</span> <span class=kt>uint</span> <span class=n>y</span><span class=p>)</span> <span class=k>internal</span> <span class=k>pure</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>uint</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint</span> <span class=n>z</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=n>z</span> <span class=o>&gt;=</span> <span class=n>x</span><span class=p>,</span> <span class=s>&#34;uint overflow&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>z</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>TestSafeMath</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>using</span> <span class=n>SafeMath</span> <span class=k>for</span> <span class=kt>uint</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=ereignisse>Ereignisse</h4><p>Der Ereignismechanismus ist ein sehr wichtiges Design in Verträgen. Ereignisse ermöglichen es, Informationen auf der Blockchain zu protokollieren, und Anwendungen wie DApps können Geschäftslogik implementieren, indem sie Ereignisdaten abhören, mit sehr geringen Speicherkosten. Hier ist ein einfacher Protokollierungsmechanismus:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// Ereignis definieren
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>event</span> <span class=nc>Log</span><span class=p>(</span><span class=kt>address</span> <span class=k>indexed</span> <span class=nb>sender</span><span class=p>,</span> <span class=kt>string</span> <span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>event</span> <span class=nc>AnotherLog</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Ereignis auslösen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>emit</span> <span class=n>Log</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=s>&#34;Hello World!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>emit</span> <span class=n>Log</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=s>&#34;Hello EVM!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>emit</span> <span class=n>AnotherLog</span><span class=p>();</span>
</span></span></code></pre></div><p>Bei der Definition eines Ereignisses können Sie das Attribut <code>indexed</code> übergeben, aber höchstens drei. Nach dem Hinzufügen können Sie die Parameter dieses Attributs filtern, <code>var event = myContract.transfer({value: ["99","100","101"]});</code>.</p><h3 id=fehlerbehandlung>Fehlerbehandlung</h3><p>Die On-Chain-Fehlerbehandlung ist auch ein wichtiger Teil des Vertragsschreibens. Solidity kann Fehler auf folgende Weise werfen.</p><p><code>require</code> wird verwendet, um Bedingungen vor der Ausführung zu überprüfen, und wenn sie nicht erfüllt sind, wird eine Ausnahme geworfen.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>function</span> <span class=nf>testRequire</span><span class=p>(</span><span class=kt>uint</span> <span class=n>_i</span><span class=p>)</span> <span class=k>public</span> <span class=k>pure</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=n>_i</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>,</span> <span class=s>&#34;Input must be greater than 10&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><code>revert</code> wird verwendet, um Fehler zu markieren und Rollbacks durchzuführen.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>function</span> <span class=nf>testRevert</span><span class=p>(</span><span class=kt>uint</span> <span class=n>_i</span><span class=p>)</span> <span class=k>public</span> <span class=k>pure</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>_i</span> <span class=o>&lt;=</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>revert</span><span class=p>(</span><span class=s>&#34;Input must be greater than 10&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><code>assert</code> erfordert, dass die Bedingung erfüllt sein muss.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>function</span> <span class=nf>testAssert</span><span class=p>()</span> <span class=k>public</span> <span class=k>view</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>assert</span><span class=p>(</span><span class=n>num</span> <span class=o>==</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Beachten Sie, dass in Solidity, wenn ein Fehler auftritt, alle Zustandsänderungen, die in der Transaktion aufgetreten sind, rückgängig gemacht werden, einschließlich aller Assets, Konten, Verträge usw.</p><p><code>try / catch</code> kann auch Fehler abfangen, kann aber nur Fehler von externen Funktionsaufrufen und Vertragserstellungen abfangen.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>event</span> <span class=nc>Log</span><span class=p>(</span><span class=kt>string</span> <span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>event</span> <span class=nc>LogBytes</span><span class=p>(</span><span class=kt>bytes</span> <span class=nb>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nf>tryCatchNewContract</span><span class=p>(</span><span class=kt>address</span> <span class=n>_owner</span><span class=p>)</span> <span class=k>public</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=k>new</span> <span class=n>Foo</span><span class=p>(</span><span class=n>_owner</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>Foo</span> <span class=n>foo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>Log</span><span class=p>(</span><span class=s>&#34;Foo created&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=n>Error</span><span class=p>(</span><span class=kt>string</span> <span class=k>memory</span> <span class=n>reason</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>Log</span><span class=p>(</span><span class=n>reason</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=kt>bytes</span> <span class=k>memory</span> <span class=n>reason</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>LogBytes</span><span class=p>(</span><span class=n>reason</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=payable-schlüsselwort><code>payable</code> Schlüsselwort</h3><p>Wir können Methoden so einstellen, dass sie <code>ether</code> von Verträgen empfangen, indem wir das <code>payable</code> Schlüsselwort deklarieren.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// Adresstyp kann als payable deklariert werden
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>address</span> <span class=k>payable</span> <span class=k>public</span> <span class=n>owner</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>constructor</span><span class=p>()</span> <span class=k>payable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>owner</span> <span class=o>=</span> <span class=k>payable</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Methode als payable deklarieren, um Ether zu empfangen
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nf>deposit</span><span class=p>()</span> <span class=k>public</span> <span class=k>payable</span> <span class=p>{}</span>
</span></span></code></pre></div><h3 id=interaktion-mit-ether>Interaktion mit <code>Ether</code></h3><p>Die Interaktion mit <code>Ether</code> ist ein wichtiges Anwendungsszenario für Smart Contracts, hauptsächlich in Sende- und Empfangsteile unterteilt, die jeweils durch verschiedene Methoden implementiert werden.</p><h4 id=senden>Senden</h4><p>Hauptsächlich durch die Methoden <code>transfer</code>, <code>send</code> und <code>call</code> implementiert. Unter ihnen wurde <code>call</code> für die Verteidigung gegen Wiedereintrittangriffe optimiert und wird für die Verwendung in tatsächlichen Anwendungsszenarien empfohlen (wird aber im Allgemeinen nicht verwendet, um andere Funktionen aufzurufen).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>SendEther</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nf>sendViaCall</span><span class=p>(</span><span class=kt>address</span> <span class=k>payable</span> <span class=n>_to</span><span class=p>)</span> <span class=k>public</span> <span class=k>payable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=kt>bool</span> <span class=n>sent</span><span class=p>,</span> <span class=kt>bytes</span> <span class=k>memory</span> <span class=nb>data</span><span class=p>)</span> <span class=o>=</span> <span class=n>_to</span><span class=p>.</span><span class=nb>call</span><span class=p>{</span><span class=nb>value</span><span class=o>:</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>}(</span><span class=s>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nb>require</span><span class=p>(</span><span class=n>sent</span><span class=p>,</span> <span class=s>&#34;Failed to send Ether&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Wenn Sie eine andere Funktion aufrufen müssen, wird im Allgemeinen <code>delegatecall</code> verwendet.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>B</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint</span> <span class=k>public</span> <span class=n>num</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=k>public</span> <span class=nb>sender</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint</span> <span class=k>public</span> <span class=nb>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>setVars</span><span class=p>(</span><span class=kt>uint</span> <span class=n>_num</span><span class=p>)</span> <span class=k>public</span> <span class=k>payable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>num</span> <span class=o>=</span> <span class=n>_num</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nb>sender</span> <span class=o>=</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nb>value</span> <span class=o>=</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>A</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint</span> <span class=k>public</span> <span class=n>num</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=k>public</span> <span class=nb>sender</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint</span> <span class=k>public</span> <span class=nb>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>setVars</span><span class=p>(</span><span class=kt>address</span> <span class=n>_contract</span><span class=p>,</span> <span class=kt>uint</span> <span class=n>_num</span><span class=p>)</span> <span class=k>public</span> <span class=k>payable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=kt>bool</span> <span class=n>success</span><span class=p>,</span> <span class=kt>bytes</span> <span class=k>memory</span> <span class=nb>data</span><span class=p>)</span> <span class=o>=</span> <span class=n>_contract</span><span class=p>.</span><span class=nb>delegatecall</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>abi</span><span class=p>.</span><span class=nb>encodeWithSignature</span><span class=p>(</span><span class=s>&#34;setVars(uint256)&#34;</span><span class=p>,</span> <span class=n>_num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=empfangen>Empfangen</h4><p>Der Empfang von <code>Ether</code> verwendet hauptsächlich zwei Methoden: <code>receive() external payable</code> und <code>fallback() external payable</code>.</p><p>Wenn eine Funktion, die keine Parameter akzeptiert und keine Parameter zurückgibt, wenn <code>Ether</code> an einen Vertrag gesendet wird, aber die <code>receive()</code> Methode nicht implementiert ist oder <code>msg.data</code> nicht leer ist, wird die <code>fallback()</code> Methode aufgerufen.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>ReceiveEther</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Wenn msg.data leer ist
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>receive</span><span class=p>()</span> <span class=k>external</span> <span class=k>payable</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Wenn msg.data nicht leer ist
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>fallback</span><span class=p>()</span> <span class=k>external</span> <span class=k>payable</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>getBalance</span><span class=p>()</span> <span class=k>public</span> <span class=k>view</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>uint</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>).</span><span class=nb>balance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=gasgebühren>Gasgebühren</h3><p>Die Ausführung von Transaktionen in der EVM erfordert Gasgebühren. <code>gas spent</code> gibt an, wie viel Gas-Menge benötigt wird, <code>gas price</code> ist der Einheitspreis von Gas, <code>Ether</code> und <code>Wei</code> sind Preiseinheiten, 1 ether == 1e18 wei.</p><p>Verträge werden Gas begrenzen. <code>gas limit</code> wird vom Benutzer festgelegt, der die Transaktion initiiert, und gibt die maximale Menge an Gas an, die ausgegeben werden soll. <code>block gas limit</code> wird vom Blockchain-Netzwerk bestimmt und gibt die maximale Menge an Gas an, die in diesem Block erlaubt ist.</p><p>Bei der Vertragsentwicklung sollten wir besonders darauf achten, so weit wie möglich Gasgebühren zu sparen. Hier sind einige gängige Techniken:</p><ol><li>Verwenden Sie <code>calldata</code> anstelle von <code>memory</code></li><li>Laden Sie Zustandsvariablen in den Speicher</li><li>Verwenden Sie <code>i++</code> anstelle von <code>++i</code></li><li>Zwischenspeichern Sie Array-Elemente</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=kd>function</span> <span class=nf>sumIfEvenAndLessThan99</span><span class=p>(</span><span class=kt>uint</span><span class=p>[]</span> <span class=n>calldata</span> <span class=n>nums</span><span class=p>)</span> <span class=k>external</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint</span> <span class=n>_total</span> <span class=o>=</span> <span class=n>total</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint</span> <span class=n>len</span> <span class=o>=</span> <span class=n>nums</span><span class=p>.</span><span class=n>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>uint</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>len</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint</span> <span class=n>num</span> <span class=o>=</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>num</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>num</span> <span class=o>&lt;</span> <span class=mi>99</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_total</span> <span class=o>+=</span> <span class=n>num</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>total</span> <span class=o>=</span> <span class=n>_total</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=fazit>Fazit</h2><p>Das oben Genannte ist der erste Artikel in unserer Serie, der die Grundlagen von Solidity behandelt. Nachfolgende Artikel werden sich auf das Lernen und Zusammenfassen seiner gängigen Anwendungen und praktischen Codiertechniken konzentrieren. Wir freuen uns auf Ihre weitere Aufmerksamkeit.</p><h2 id=referenzen>Referenzen</h2><blockquote><ol><li><a href=https://solidity-by-example.org>Solidity by Example</a></li><li><a href=http://gasolin.idv.tw/learndapp/>Ethereum Blockchain! Einführung in Smart Contracts und dezentrale Webanwendungen (dApps)</a></li><li><a href=https://www.pseudoyu.com/blockchain-guide/>Blockchain Beginner&rsquo;s Guide</a></li><li><a href=https://github.com/pseudoyu/uright>Uright - Blockchain Music Copyright Management ÐApp</a></li></ol></blockquote></articl><h2>Verwandte Beiträge</h2><dl class=row></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2023-09-13</dt><dd class=col-md-9><a href=/de/2023/09/13/weekly_review_20230913/>Wochenrückblick #46 - Abschied von langen Haaren, ursprüngliche Intention des Wochenrückblicks und Vertragsentwicklung</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2023-04-30</dt><dd class=col-md-9><a href=/de/2023/04/30/weekly_review_20230430/>Wochenrückblick #38 - Foundry Contract-Tests, Logseq Aufgabenverwaltung und Surge Ponte Remote-Entwicklung</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2022-07-01</dt><dd class=col-md-9><a href=/de/2022/07/01/two_phase_commit_contract_practice_in_solidity/>Implementierung von Two-Phase Commit in Solidity Smart Contracts unter Verwendung von State Locks</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2022-06-09</dt><dd class=col-md-9><a href=/de/2022/06/09/learn_solidity_from_scratch_hardhat/>Solidity Smart Contract Entwicklung - Verwendung des Hardhat Frameworks</a></dd></dl></dl><dt class=col-md-3>2022-06-08</dt><dd class=col-md-9><a href=/de/2022/06/08/learn_solidity_from_scratch_ethersjs/>Solidity Smart Contract Entwicklung - Beherrschung von ethers.js</a></dd></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><div class=author-card><div class=underline></div><div class=author-box><div class=author-image><a href=https://www.pseudoyu.com><img src=/images/author.webp alt=pseudoyu></a></div><div class=author-content><p class=author-title>Autor</p><p class=author-name>pseudoyu</p><p class=author-desc>Backend- & Smart-Contract-Entwickler, MSc-Absolvent in ECIC (Electronic Commerce and Internet Computing) an der Universität Hongkong (HKU). Lerne und entwickle gerne Neues. <a href=https://github.com/pseudoyu>Folge mir auf GitHub</a></p></div></div></div><div align=center><div class=comment-underline></div></div><br><div class=comments><div class=title><span>Comments</span>
<span class=counter><span class=remark42__counter data-url=https://www.pseudoyu.com/de/2022/05/25/learn_solidity_from_scratch_basic/></span></span></div><div id=remark42></div></div><script>var remark_config={host:"https://comments.pseudoyu.com",site_id:"pseudoyu.com",components:["embed","counter"],max_shown_comments:20,simple_view:!0,theme:"light"}</script><script>(function(){const t=window.REMARK42;if(t)t.destroy(),t.createInstance(remark_config);else for(const t of remark_config.components){var n=document,e=n.createElement("script");e.src=`${remark_config.host}/web/${t}.mjs`,e.type="module",e.defer=!0,e.setAttribute("data-no-instant",""),n.head.appendChild(e)}})()</script></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>Sitemap</div><ul class=list-unstyled><li><a href=https://www.pseudoyu.com/de/tags/>Schlagworte</a></li><li><a href=https://www.pseudoyu.com/de/categories/>Kategorien</a></li><li><a rel=alternate type=application/rss+xml href=https://www.pseudoyu.com/de/index.xml><i class="fas fa-rss-square"></i> RSS-Feed</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>Social</div><ul class=list-unstyled><li><a href=https://t.me/pseudoyulife rel=noopener target=_blank>Telegram</a></li><li><a href=https://twitter.com/pseudo_yu rel=noopener target=_blank>Twitter</a></li><li><a href=https://www.instagram.com/pseudo.yu/ rel=noopener target=_blank>Instagram</a></li><li><a href=https://space.bilibili.com/5374948/ rel=noopener target=_blank>BiliBili</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>Links</div><ul class=list-unstyled><li><a href=https://github.com/pseudoyu rel=noopener target=_blank>Yu's GitHub</a></li></ul></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em><a href="https://stats.pseudoyu.com?access-token=2m1u5i2k413q0733h2a3332w3m1t6r634g1m6n" rel=noopener target=_blank>Yu's blog analytics</a></em></small><br><small><em>Powered by <a href=https://gohugo.io rel=noopener target=_blank>Hugo</a> - <a href=https://github.com/shaform/hugo-theme-den rel=noopener target=_blank>den</a></em></small><br><small><em><a href=https://www.hku.hk rel=noopener target=_blank>The University of Hong Kong</a> - <a href=https://www.cs.hku.hk rel=noopener target=_blank>CS</a></em></small><br><small>&copy;
Yu Zhang
2020 -
2024</small></p></div><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" id=scroll-top class=scroll-top accesskey=g><span class=arrow-icon></span></a>
<script>var mybutton=document.getElementById("scroll-top");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script></body></html>